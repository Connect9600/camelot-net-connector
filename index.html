<html><head><link rel="stylesheet" href="styles.css"></head><body><div id="section"><a name="-3_5"><i>/3_5</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
            

            
  
  
  <h2>Table of Contents</h2>
  <div>
  <div id="tw">
	<table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-intended-audience" id="twn0" style="text-decoration:none;border-style:none;">Intended audience</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-sharepoint-and-net" id="twn1" style="text-decoration:none;border-style:none;">SharePoint and .NET</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-installation" id="twn2" style="text-decoration:none;border-style:none;">Installation</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-visual-studio" id="twn3" style="text-decoration:none;border-style:none;">Visual Studio</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-programming" id="twn4" style="text-decoration:none;border-style:none;">Programming</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-introduction" id="twn5" style="text-decoration:none;border-style:none;">Introduction</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#introduction-sharepointconnection" id="twn6" style="text-decoration:none;border-style:none;">SharePointConnection</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#introduction-sharepointcommand" id="twn7" style="text-decoration:none;border-style:none;">SharePointCommand</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#introduction-sharepointdataadapter" id="twn8" style="text-decoration:none;border-style:none;">SharePointDataAdapter</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#introduction-sharepointparameter" id="twn9" style="text-decoration:none;border-style:none;">SharePointParameter</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-the-connection-string" id="twn10" style="text-decoration:none;border-style:none;">The connection string</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#the-connection-string-basic-options" id="twn11" style="text-decoration:none;border-style:none;">Basic options</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#the-connection-string-performance" id="twn12" style="text-decoration:none;border-style:none;">Performance</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#the-connection-string-security" id="twn13" style="text-decoration:none;border-style:none;">Security</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-executing-commands" id="twn14" style="text-decoration:none;border-style:none;">Executing commands</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-command-types" id="twn15" style="text-decoration:none;border-style:none;">Command types</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-last-inserted-id" id="twn16" style="text-decoration:none;border-style:none;">Last inserted id</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-last-records-affected" id="twn17" style="text-decoration:none;border-style:none;">Last records affected</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-change-database" id="twn18" style="text-decoration:none;border-style:none;">Change database</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-helper-class" id="twn19" style="text-decoration:none;border-style:none;">Helper class</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#executing-commands-strings-and-escaping" id="twn20" style="text-decoration:none;border-style:none;">Strings and escaping</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-data-types" id="twn21" style="text-decoration:none;border-style:none;">Data types</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-guid" id="twn22" style="text-decoration:none;border-style:none;">GUID</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-counter" id="twn23" style="text-decoration:none;border-style:none;">Counter</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-boolean" id="twn24" style="text-decoration:none;border-style:none;">Boolean</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-datetime" id="twn25" style="text-decoration:none;border-style:none;">DateTime</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-integer" id="twn26" style="text-decoration:none;border-style:none;">Integer</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-number-currency" id="twn27" style="text-decoration:none;border-style:none;">Number / Currency</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-text" id="twn28" style="text-decoration:none;border-style:none;">Text</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-note" id="twn29" style="text-decoration:none;border-style:none;">Note</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-url" id="twn30" style="text-decoration:none;border-style:none;">URL</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-choice-multichoice" id="twn31" style="text-decoration:none;border-style:none;">Choice / MultiChoice</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-lookup-lookupmulti" id="twn32" style="text-decoration:none;border-style:none;">Lookup / LookupMulti</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-user-usermulti" id="twn33" style="text-decoration:none;border-style:none;">User / UserMulti</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-calculated" id="twn34" style="text-decoration:none;border-style:none;">Calculated</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-computed" id="twn35" style="text-decoration:none;border-style:none;">Computed</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-attachments" id="twn36" style="text-decoration:none;border-style:none;">Attachments</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-binary" id="twn37" style="text-decoration:none;border-style:none;">Binary</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#data-types-modstat" id="twn38" style="text-decoration:none;border-style:none;">ModStat</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-tutorials" id="twn39" style="text-decoration:none;border-style:none;">Tutorials</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#tutorials-aspnet" id="twn40" style="text-decoration:none;border-style:none;">ASP.NET</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#tutorials-download-documents" id="twn41" style="text-decoration:none;border-style:none;">Download documents</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#tutorials-nhibernate" id="twn42" style="text-decoration:none;border-style:none;">NHibernate</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#programming-license-files" id="twn43" style="text-decoration:none;border-style:none;">License files</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-sql-statement-syntax" id="twn44" style="text-decoration:none;border-style:none;">SQL statement syntax</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-show-databases" id="twn45" style="text-decoration:none;border-style:none;">SHOW DATABASES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-show-tables" id="twn46" style="text-decoration:none;border-style:none;">SHOW TABLES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-show-columns" id="twn47" style="text-decoration:none;border-style:none;">SHOW COLUMNS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-show-views" id="twn48" style="text-decoration:none;border-style:none;">SHOW VIEWS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-show-contenttypes" id="twn49" style="text-decoration:none;border-style:none;">SHOW CONTENTTYPES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-select" id="twn50" style="text-decoration:none;border-style:none;">SELECT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-insert" id="twn51" style="text-decoration:none;border-style:none;">INSERT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-update" id="twn52" style="text-decoration:none;border-style:none;">UPDATE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-delete" id="twn53" style="text-decoration:none;border-style:none;">DELETE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-join" id="twn54" style="text-decoration:none;border-style:none;">JOIN</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-group-by" id="twn55" style="text-decoration:none;border-style:none;">GROUP BY</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-union" id="twn56" style="text-decoration:none;border-style:none;">UNION</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-call" id="twn57" style="text-decoration:none;border-style:none;">CALL</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-use" id="twn58" style="text-decoration:none;border-style:none;">USE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-last_insert_id()" id="twn59" style="text-decoration:none;border-style:none;">LAST_INSERT_ID()</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#sql-statement-syntax-operators-and-functions" id="twn60" style="text-decoration:none;border-style:none;">Operators and functions</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#operators-and-functions-string-functions" id="twn61" style="text-decoration:none;border-style:none;">String functions</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#operators-and-functions-date-functions" id="twn62" style="text-decoration:none;border-style:none;">Date functions</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#operators-and-functions-numeric-functions" id="twn63" style="text-decoration:none;border-style:none;">Numeric functions</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#operators-and-functions-aggregate-functions" id="twn64" style="text-decoration:none;border-style:none;">Aggregate functions</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-procedures" id="twn65" style="text-decoration:none;border-style:none;">Procedures</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-createfolder" id="twn66" style="text-decoration:none;border-style:none;">CREATEFOLDER</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-createdocumentset" id="twn67" style="text-decoration:none;border-style:none;">CREATEDOCUMENTSET</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-upload" id="twn68" style="text-decoration:none;border-style:none;">UPLOAD</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-download" id="twn69" style="text-decoration:none;border-style:none;">DOWNLOAD</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-downloadinfopath" id="twn70" style="text-decoration:none;border-style:none;">DOWNLOADINFOPATH</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-delete" id="twn71" style="text-decoration:none;border-style:none;">DELETE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-move" id="twn72" style="text-decoration:none;border-style:none;">MOVE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-copy" id="twn73" style="text-decoration:none;border-style:none;">COPY</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-rename" id="twn74" style="text-decoration:none;border-style:none;">RENAME</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-checkout" id="twn75" style="text-decoration:none;border-style:none;">CHECKOUT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-checkin" id="twn76" style="text-decoration:none;border-style:none;">CHECKIN</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-undocheckout" id="twn77" style="text-decoration:none;border-style:none;">UNDOCHECKOUT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-getversions" id="twn78" style="text-decoration:none;border-style:none;">GETVERSIONS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-deleteversion" id="twn79" style="text-decoration:none;border-style:none;">DELETEVERSION</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-deleteallversions" id="twn80" style="text-decoration:none;border-style:none;">DELETEALLVERSIONS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-restoreversion" id="twn81" style="text-decoration:none;border-style:none;">RESTOREVERSION</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-downloadattachment" id="twn82" style="text-decoration:none;border-style:none;">DOWNLOADATTACHMENT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-uploadattachment" id="twn83" style="text-decoration:none;border-style:none;">UPLOADATTACHMENT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-deleteattachment" id="twn84" style="text-decoration:none;border-style:none;">DELETEATTACHMENT</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-getcolumnversions" id="twn85" style="text-decoration:none;border-style:none;">GETCOLUMNVERSIONS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-createlistfromtemplate" id="twn86" style="text-decoration:none;border-style:none;">CREATELISTFROMTEMPLATE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-setreadwrite" id="twn87" style="text-decoration:none;border-style:none;">SETREADWRITE</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#procedures-setreadonly" id="twn88" style="text-decoration:none;border-style:none;">SETREADONLY</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#3_5-reference" id="twn89" style="text-decoration:none;border-style:none;">Reference</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-show-databases" id="twn90" style="text-decoration:none;border-style:none;">SHOW DATABASES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-show-tables" id="twn91" style="text-decoration:none;border-style:none;">SHOW TABLES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-show-columns" id="twn92" style="text-decoration:none;border-style:none;">SHOW COLUMNS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-show-views" id="twn93" style="text-decoration:none;border-style:none;">SHOW VIEWS</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-show-contenttypes" id="twn94" style="text-decoration:none;border-style:none;">SHOW CONTENTTYPES</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-connection-string-options" id="twn95" style="text-decoration:none;border-style:none;">Connection String Options</a></td>
		</tr>
	</table><table cellpadding="0" cellspacing="0" style="border-width:0;">
		<tr>
			<td></td><td class="NodeStyle" style="white-space:nowrap;"><a class="NodeStyle" href="#reference-column-types" id="twn96" style="text-decoration:none;border-style:none;">Column Types</a></td>
		</tr>
	</table>
</div>  
  </div>

        </div><hr/></div><div id="section"><a name="3_5-intended-audience"><i>/3_5/intended-audience</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Intended audience</h1>

            
  
  <p>This guide is intended for .NET application programmers who want to use the Camelot .NET Connector to develop .NET applications that require secure, high-performance data connectivity with SharePoint 2007, 2010 or 2013, Windows SharePoint Services (WSS 3.0), or SharePoint Foundation (WSS 4.0). Developers can build applications using their choice of .NET languages. This guide assumes that you have understanding in the following areas:</p>
<ul>
<li>Programming in .NET C# or VB</li>
<li>ADO.NET</li>
<li>SQL statement syntax</li>
<li>Basic SharePoint understanding</li>
</ul>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-sharepoint-and-net"><i>/3_5/sharepoint-and-net</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SharePoint and .NET</h1>

            
  
  <p style="text-align: justify;">Microsoft SharePoint is quickly becoming a dominate application for storing and maintaining enterprise data and intelligence for organizations of all sizes. This has created a need and opportunity for people who has specialized in data integration and visualization between SharePoint and external applications. In SharePoint 2007 there are a few options. You can use web services to interact with SharePoint lists and other features or use the server object model to extend the capabilities. With SharePoint 2010, Microsoft has stepped up by introducing the client object model, making it possible to use the object model remotely. Querying the underlying SharePoint SQL server directly is not recommended, because the underlying SharePoint database is highly sensitive to data integrity and consistency.</p>
<p style="text-align: justify;">Many developers out there experience that the learning time to be able to rapidly develop applications working with SharePoint is too long. The developer often spend a lot of time understanding the SharePoint data structure, naming conventions and data type conversion requirements. The developer also needs to understand the CAML (Collaborative Application Markup Language) syntax used to query lists and views. The code tends to grow to a size that is not in proportion to the functionality.</p>
<p style="text-align: justify;">The Camelot .NET Connector lets you easily develop .NET applications that require secure, high-performance data connectivity with SharePoint using standard SQL language. It implements the required ADO.NET interfaces and integrates into ADO.NET aware tools. Developers can build applications using their choice of .NET languages.</p>
<p>Besides standard CRUD operations, the Connector supports features that you will not find in any other tool, such as JOIN and UNION. The Connector can be used by any developer with basic SQL knowledge.</p>
<h3>Code examples</h3>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Title, PhoneNumber FROM Customers ORDER BY ID DESC LIMIT 10, 10&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;PhoneNumber&quot;].ToString().PadRight(30));
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;
Using connection = New SharePointConnection(connectionString)
    connection.Open()
    Using command = New SharePointCommand(&quot;SELECT Title, PhoneNumber FROM Customers ORDER BY ID DESC LIMIT 10, 10&quot;, connection)
        Using reader = command.ExecuteReader()
            While reader.Read()
                Console.WriteLine(reader(&quot;Title&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;PhoneNumber&quot;).ToString().PadRight(30))
            End While
        End Using
    End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Customers SET Name = &#39;Anne Baxter&#39; WHERE ID = 5&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
    connection.Close();
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Customers SET Name = &#39;Anne Baxter&#39; WHERE ID = 5&quot;, connection)
		command.ExecuteNonQuery()
	End Using
	connection.Close()
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Join example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers INNER JOIN Log ON Log.Customer = Customers.ID WHERE Customers.ID = 6 ORDER BY Log.Created ASC&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;
Using connection = New SharePointConnection(connectionString)
    connection.Open()
    Using command = New SharePointCommand(&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers INNER JOIN Log ON Log.Customer = Customers.ID WHERE Customers.ID = 6 ORDER BY Log.Created ASC&quot;, connection)
        Using reader = command.ExecuteReader()
            While reader.Read()
                Console.WriteLine(reader(&quot;Name&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;Event&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;Created&quot;).ToString())
            End While
        End Using
    End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Union example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT ID, Title FROM Customers UNION DISTINCT SELECT ID, Title FROM CustomersBackup ORDER BY ID ASC&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;ID&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Title&quot;].ToString());
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Authentication=Ntlm;TimeOut=10;DefaultLimit=1000;CacheTimeout=30&quot;
Using connection = New SharePointConnection(connectionString)
    connection.Open()
    Using command = New SharePointCommand(&quot;SELECT ID, Title FROM Customers UNION DISTINCT SELECT ID, Title FROM CustomersBackup ORDER BY ID ASC&quot;, connection)
        Using reader = command.ExecuteReader()
            While reader.Read()
                Console.WriteLine(reader(&quot;ID&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;Title&quot;).ToString())
            End While
        End Using
    End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-installation"><i>/3_5/installation</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Installation</h1>

            
  
  <h3>Prerequisities</h3>
<ul>
<li>Microsoft .NET Framework 3.5 or 4 (choose the version of your choice)</li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=17331" target="_blank">Windows Identity Foundation</a> (only required for Office 365 authentication)</li>
</ul>
<p>Before installing, ensure that your system is up to date, including installing the latest version of the .NET Framework.</p>
<p>You install the Camelot .NET Connector by running the Connector installation setup executable. The Connector can be installed on all Windows operating systems.</p>
<p>Use the <strong>Camelot License Key Manager</strong> to check the status of your license key and development license renewal. Production license must be purchased through the Bendsoft website. For information about how to manage license files in code see the <a href="#programming-license-files" target="_blank" title="License files">License files</a> section.</p>

<h3>Installing the Camelot .NET Connector</h3>
<p>To install the Connector:</p>
<p><strong>1.</strong> Download the <a href="http://bendsoft.com/net-sharepoint-connector/download/">Camelot .NET Connector</a>.</p>
<p><strong>2.</strong> Double-click the installer file you downloaded. Click <strong>Next</strong> to start the wizard.</p>
<p><strong>3.</strong> Read and confirm the license agreement.</p>

<p><strong>4.</strong> Choose the location on your hard drive where you want to install the Connector.</p>

<p><strong>5.</strong> Choose the name of the Connector shortcut menu folder.</p>

<p><strong> 6.</strong> Click <strong>Install</strong> to begin installation.</p>

<p><strong>7.</strong> Choose your choice of license key registration. If you have purchased a license or already have a development license installed on you computer, select the first choice. To register for a trial license, select the second choice.</p>

<p><strong>8.</strong> Register for a trial license by filling in the form below. Click <strong>Register</strong> to complete registration.</p>

<p><strong>9.</strong> If the registration is successful you will see the following message.</p>

  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-visual-studio"><i>/3_5/visual-studio</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Visual Studio</h1>

            
  
  <p>In order to use the Camelot .NET Connector in your application, you must first add a reference to it in Visual Studio. The Connector assembly will automatically appear in the Visual Studio .NET assembly list.</p>
<p>To add a reference to the Connector:</p>
<p><strong>1.</strong> In <strong>Solution Explorer</strong>, double-click the project node.</p>
<p><strong>2.</strong> Click <strong>Add</strong> to open the <strong>Add Reference</strong> dialog box.</p>
<p><strong>3.</strong> In the <strong>Add Reference</strong> dialog box and select the .NET tab.</p>
<p><strong>4.</strong> Select the <em>Camelot.SharePointConnector.dll</em> for Framework 2 or 4, depending on your project runtime version and click <strong>OK</strong>.</p>
<p></p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-programming"><i>/3_5/programming</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Programming</h1>

            
  
  <p>In the following sections, you will learn about programming with the Camelot .NET Connector, including connection string options, command types and data types.</p>
  
  

        </div><hr/></div><div id="section"><a name="programming-introduction"><i>/3_5/programming/introduction</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Introduction</h1>

            
  
  <p>The Camelot .NET Connector is based on ADO.NET, a managed API for the .NET Framework to access and modify data commonly stored in relation database systems. One of the advantages using ADO.NET is the ability to work with decoupled data using the built-in DataSet and DataTable classes. The Connector comprises several classes that are used to connect to the database, execute queries and statements, and manage query results.</p>
<p>The following are the major classes of the Connector:</p>
<ul>
<li><strong>SharePointConnection</strong>: Represents a connection to a SharePoint server.</li>
<li><strong>SharePointCommand</strong>: Represents an SQL statement to execute against a SharePoint server.</li>
<li><strong>SharePointParameter</strong>: Represents a named parameter with an associated value that are used with SharePointCommand's to safely handle user provided data in SQL queries.</li>
<li><strong>SharePointDataReader</strong>: Provides forward-only reading of data rows returned from a SharePoint server.</li>
<li><strong>SharePointDataAdapter</strong>: Represents a set of methods that are used to load data into a DataSet or a DataTable.</li>
<li><strong>SharePointConnectorException</strong>: Represents an exception thrown when a command or server error occurs in the Connector.</li>
<li><strong>SharePointFactory</strong>: Represents a set of methods used to create instances of classes implemented by Connector in the ADO.NET architecture.</li>
</ul>
<p>In the following sections, you will learn the basic methods used to query with the Connector.</p>
  
  

        </div><hr/></div><div id="section"><a name="introduction-sharepointconnection"><i>/3_5/programming/introduction/sharepointconnection</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SharePointConnection</h1>

            
  
  <p style="text-align: left;">For your application to be able to work with SharePoint it needs to establish a connection to the SharePoint server. This communication is handled by the SharePointConnection object. The SharePointConnection constructor takes a connection string as as first parameter, providing necessary information to establish a connection to the server.</p>
<p style="text-align: left;"><strong>Constructors</strong></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Description</th></tr>
<tr>
<td>SharePointConnection()</td>
<td>Initializes a new instance.</td>
</tr>
<tr>
<td>SharePointConnection(string connectionString)</td>
<td>Initializes a new instance with the specified connection string.</td>
</tr>
</tbody>
</table>
<h3>Building the connection string</h3>
<p>The SharePointConnection is configured by providing a connection string that consists of several key/value pairs split with equal signs and separated by semicolons.</p>
<p>Consider the following connection string:</p>
<p class="code">Server=localhost;Authentication=Ntlm;User=spuser;Password=12345;</p>
<p>In this example, the connection string tells the SharePointConnection instance to connect to SharePoint at <strong>localhost</strong> and authenticate using the Ntlm protocol with user name <strong>spuser</strong> and password <strong>12345</strong>. The Connector provides several connection string options that can be used to change the default behaviour when executing commands. For a list of supported connection string options, see <a href="#reference-connection-string-options">Connection String Options</a>.</p>
<h3>Open a connection</h3>
<p>The following example shows show to create a new connection.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Connecting to SharePoint</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();
                    // Perform operations
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p style="text-align: left;">When the SharePointConnection constructor is invoked, it returns a connection object, which is used for subsequent SharePoint operations. Before you can do anything else you need to open the connection. The connection string in this example provides typical information required to connect to a SharePoint servern using the NTLM authentication protocol. The database option corresponds to the site name or site path on the sharepoint server. The connection can only be used to query contents in the specified site. Before the application exits, dispose or close the connection to the database by calling the Close method on the connection. Sometimes an attempt to perform an Open on a connection object can fail, generating an exception that can be handled using standard exception handling code.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="introduction-sharepointcommand"><i>/3_5/programming/introduction/sharepointcommand</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SharePointCommand</h1>

            
  
  <p>Once a connection has been established with SharePoint, all SQL operations are carried out through the use of the SharePointCommand object. There are three main methods of interest that you can call:</p>
<ul>
<li><strong>ExecuteReader</strong> - Used to query data. The results are read through the SharePointDataReader object returned by this method.</li>
<li><strong>ExecuteNonQuery</strong> - Used to update or delete data. This method returns an Integer value indicating the number of rows changed, updated or deleted by the query.</li>
<li><strong>ExecuteScalar</strong> - Used to query for a single value. This method returns the value of the first column in the first row returned by the query.</li>
</ul>
<p><strong>Constructors</strong></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Description</th></tr>
<tr>
<td>SharePointCommand()</td>
<td>Initializes a new instance.</td>
</tr>
<tr>
<td>SharePointCommand(string commandText)</td>
<td>Initializes a new instance with the specified SQL query.</td>
</tr>
<tr>
<td>SharePointCommand(string commandText, SharePointConnection connection)</td>
<td>Initializes a new instance with the specified SQL query and connection.</td>
</tr>
</tbody>
</table>
<p>Before a command can be used to execute operations, it needs to be initialized with the connection to use and the SQL statement to execute. The following example shows how to prepare and execute a query and then read the return values through the SharePointDataReader object.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteReader</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();

                    using (var command = new SharePointCommand(@&quot;SELECT ID, Name FROM Employees WHERE Role = &#39;Developer&#39; ORDER BY ID ASC LIMIT 30&quot;, connection))
                    {
                        using (var reader = command.ExecuteReader())
                        {
                            while (reader.Read())
                            {
                                Console.WriteLine(reader[&quot;ID&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Name&quot;].ToString());
                            }
                        }
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()

                Using command = New SharePointCommand(&quot;SELECT ID, Name FROM Employees WHERE Role = &#39;Developer&#39; ORDER BY ID ASC LIMIT 30&quot;, connection)
                    Using reader = command.ExecuteReader()
                        While reader.Read()
                            Console.WriteLine(reader(&quot;ID&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;Name&quot;).ToString())
                        End While
                    End Using
                End Using
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p>In this example, the SQL query and the SharePointConnection object is passed to the SharePointCommand object in the constructor. It is important that the connection has been opened before executing the query or an exception will be thrown. The ExecuteReader method carries out the operation and returns a SharePointDataReader object that can be used to iterate through the data result returned from SharePoint. This example code simply prints out the information in a while loop.</p>
<p>Finally, it is important to close the SharePointDataReader object by disposing the object or calling the Close method on it. By doing so, the SharePointCommand is released from the SharePointDataReader and ready to be used again to execute next query.</p>
<p>The next example shows how to use the ExecuteNonQuery method to insert data in SharePoint.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteNonQuery</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();

                    using (var command = new SharePointCommand(@&quot;INSERT INTO Employees (Name, Role) VALUES (&#39;Clark Griswold&#39;, &#39;Developer&#39;)&quot;, connection))
                    {
                        command.ExecuteNonQuery();
                        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()

                Using command = New SharePointCommand(&quot;INSERT INTO Employees (Name, Role) VALUES (&#39;Clark Griswold&#39;, &#39;Developer&#39;)&quot;, connection)
                    command.ExecuteNonQuery()
                    Console.WriteLine(&quot;ID = &quot; &amp; Convert.ToString(command.LastInsertedId))
                End Using
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p>Since the ExecuteNonQuery method only returns records affected by the query, it is not always important to handle the result. In this example, we know that if command succeeds, the return value will be one. Finally, we can use the LastInsertedId method on the command object to print out the ID of the new record inserted in SharePoint. The ID can then be used to execute subsequent queries on the same record.</p>
<p>The last example shows how to use ExecuteScalar to return a single value.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteScalar</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();

                    using (var command = new SharePointCommand(@&quot;SELECT ID FROM Employees ORDER BY ID DESC&quot;, connection))
                    {
                        var ret = command.ExecuteScalar();

                        if (ret != null)
                            Console.WriteLine(&quot;Max Employee ID = &quot; + Convert.ToInt32(ret));
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()

                Using command = New SharePointCommand(&quot;SELECT ID FROM Employees ORDER BY ID DESC&quot;, connection)
                    Dim ret = command.ExecuteScalar()

                    If ret IsNot Nothing Then
                        Console.WriteLine(&quot;Max Employee ID = &quot; &amp; Convert.ToInt32(ret))
                    End If
                End Using
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p>This simple example code uses a simple query to find out the Employee with the highest ID.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="introduction-sharepointdataadapter"><i>/3_5/programming/introduction/sharepointdataadapter</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SharePointDataAdapter</h1>

            
  
  <p>In the previous SharePointDataReader examples, the connection was maintained opened until explicitly closed, which is normally done after all records have been processed. The SharePointDataAdapter object can be used to work with decoupled data, thus allowing the connection to be used in subsequent operations. This is done by calling the <strong>Fill</strong> method on the SharePointDataAdapter, which loads all data into a <strong>DataSet </strong>or a <strong>DataTable</strong>. The adapter is responsible for managing the connection state, opening and closing the connection as needed.</p>
<p><strong>Constructors</strong></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Description</th></tr>
<tr>
<td>SharePointDataAdapter()</td>
<td>Initializes a new instance.</td>
</tr>
<tr>
<td>SharePointDataAdapter(SharePointCommand selectCommand)</td>
<td>Initializes a new instance with the specified SQL SELECT command.</td>
</tr>
<tr>
<td>SharePointDataAdapter(string selectCommandText, SharePointConnection selectConnection)</td>
<td>Initializes a new instance with the specified SQL SELECT query and connection.</td>
</tr>
<tr>
<td>SharePointDataAdapter(string selectCommandText, string selectConnectionString)</td>
<td>Initializes a new instance with the specified SQL SELECT query and connection string.</td>
</tr>
</tbody>
</table>
<p>The following example shows how to use the SharePointDataAdapter object to load the data returned by a select query into a DataTable.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>SharePointDataAdapter</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();

                    var employees = new DataTable(&quot;Employees&quot;);
                    using (var command = new SharePointCommand(@&quot;SELECT * FROM Employees&quot;, connection))
                    {
                        using (var adapter = new SharePointDataAdapter(command))
                        {
                            // Fill DataTable
                            adapter.Fill(employees);
                        }
                    }

                    // Process decoupled data
                    Console.WriteLine(&quot;Number of employees = &quot; + employees.Rows.Count);
                    foreach (DataColumn column in employees.Columns)
                        Console.WriteLine(&quot;Column &quot; + column.Ordinal + &quot; : &quot; + column.ColumnName + &quot; (&quot; + column.DataType.Name + &quot;)&quot;);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()

                Dim employees = New DataTable(&quot;Employees&quot;)
                Using command = New SharePointCommand(&quot;SELECT * FROM Employees&quot;, connection)
                    Using adapter = New SharePointDataAdapter(command)
                        adapter.Fill(employees)
                    End Using
                End Using

                Console.WriteLine(&quot;Number of employees = &quot; &amp; employees.Rows.Count)
                For Each column As DataColumn In employees.Columns
                    Console.WriteLine(&quot;Column &quot; &amp; column.Ordinal &amp; &quot; : &quot; &amp; column.ColumnName &amp; &quot; (&quot; &amp; column.DataType.Name &amp; &quot;)&quot;)
                Next
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p>In this example, the SharePointDataAdapter is used to fetch all records from the Employees list into a DataTable and print out the the total number of records and the name and datatype of each column in the list. Note that the SharePointConnection object does not need to be opened before calling the Fill method, because the adapter knows how to handle this. However, if you choose to open the connection before calling the Fill method, the connection will remain open even after.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="introduction-sharepointparameter"><i>/3_5/programming/introduction/sharepointparameter</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SharePointParameter</h1>

            
  
  <p>In a typical application the user will have to provide user input that goes into the SQL query. Although it is possible to build the SQL query directly from the user input, this is not recommended as it introduces the possibility to enter erroneous or dangerous information that could harm your system. The use of parameters eliminates this risk at the same time making your code more readable. A parameter is simpy a named placeholder in your SQL query, preceded with an '@' symbol to indicate that it is a parameter. The value that corresponds to the placeholder is then added to the command object using the Parameters member, which holds a collection of SharePointParameter objects. The following example shows how this work.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>SharePointParameter</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>using System;
using System.Data;
using Camelot.SharePointConnector.Data;

namespace ExampleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
            using (var connection = new SharePointConnection(connectionString))
            {
                try
                {
                    Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
                    connection.Open();

                    using (var command = new SharePointCommand(@&quot;SELECT ID, Name FROM Employees WHERE Role = @role&quot;, connection))
                    {
                        Console.WriteLine(&quot;Enter the role to search: &quot;);
                        var role = Console.ReadLine();

                        command.Parameters.Add(&quot;@role&quot;, role);
                        using (var reader = command.ExecuteReader())
                        {
                            while (reader.Read())
                            {
                                Console.WriteLine(reader[&quot;ID&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Name&quot;].ToString());
                            }
                        }
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
                Console.WriteLine(&quot;Done&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Imports System
Imports System.Data
Imports Camelot.SharePointConnector.Data

Module Module1
    Sub Main()
        Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
        Using connection = New SharePointConnection(connectionString)
            Try
                Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
                connection.Open()

                Using command = New SharePointCommand(&quot;SELECT ID, Name FROM Employees WHERE Role = @role&quot;, connection)
                    Console.WriteLine(&quot;Enter the role to search: &quot;)
                    Dim role = Console.ReadLine()

                    command.Parameters.Add(&quot;@role&quot;, role)
                    Using reader = command.ExecuteReader()
                        While reader.Read()
                            Console.WriteLine(reader(&quot;ID&quot;).ToString().PadRight(30) &amp; &quot; : &quot; &amp; reader(&quot;Name&quot;).ToString())
                        End While
                    End Using
                End Using
            Catch ex As Exception
                Console.WriteLine(ex.ToString())
            End Try
            Console.WriteLine(&quot;Done&quot;)
        End Using
    End Sub
End Module</code></pre></div></div>
</div>
<p>In this example, the role value in where clause has been replaced with a parameter and the value is asked from the user. This ensures that the user cannot enter harmful information to query.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="programming-the-connection-string"><i>/3_5/programming/the-connection-string</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>The connection string</h1>

            
  
  <p>This chapter describes most of the connection string options available in the Camelot .NET Connector. Some options indicate how data is selected or transfered while other options affect performance or security. It is recommeded that you read this chapter carefully because some options may be important for the behaviour of your application.</p>
<p><span>For the complete list of connection string options see </span><a href="#reference-connection-string-options">Connection String Options.</a> For general introduction of the connection string and usage see <a href="#introduction-sharepointconnection">SharePointConnection</a>.</p>
  
  

        </div><hr/></div><div id="section"><a name="the-connection-string-basic-options"><i>/3_5/programming/the-connection-string/basic-options</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Basic options</h1>

            
  
  <p>This section describes some basic connection string options that have direct effect on command execution and how data is returned from SharePoint. It is important to learn about these options in order to work with different scenarios.</p>
<hr>
<h3>Authentication</h3>
<p>The Authentication option determines the method used to authenticate with the server. Possible values are <em>Default</em>, <em>Ntlm</em> and <em>Basic</em>. The default is <em>Ntlm</em> (commonly used). Setting this option to <em>Default</em>, tells the Connector to impersonate the user under which the application is running. This is very useful in integration scenarios for applications that are running under the same active directory.</p>
<p class="doccode">Server=localhost;<strong><span>Authentication</span></strong>=Default;</p>
<hr>
<h3>Timeout</h3>
<p>The TimeOut option is used to set the time in seconds that the underlying connection to SharePoint will wait for a send or receive operation to complete before raising an exception. The full operation is however still allowed to take longer than the configured time limit. The CommandTimeout property associated with the SharePointCommand class should not be used for this purpose. The default value for the TimeOut option is <strong>60 seconds.</strong> The following connection string sets the timeout to 120 seconds.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>TimeOut</strong>=120;</p>
<hr>
<h3>RecursiveMode</h3>
<p>The RecursiveMode option implements a SharePoint Webservice attribute that controls the scope of items returned when executing SELECT queries on lists that contain sub folders. This option takes any of the following values:</p>
<ul>
<li><strong>FilesOnly</strong>: Files from the current folder only will be selected.</li>
<li><strong>Recursive</strong>: Files from the current folder including all sub folders will be selected to a flat list view.</li>
<li><strong>RecursiveAll (default)</strong>: Files and folders from the current folder including all sub folders will be selected to a flat list view.</li>
</ul>
<p>By default, regular list items (files) and folders are recursively merged and presented as a flat view of list items when executing SELECT statements on lists and views. In some scenarios this is not desirable, for example when working with folder browsing. The following connection string modifies the default behaviour to select list items in the current sub folder only.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>RecursiveMode</strong>=FilesOnly;</p>
<hr>
<h3>DefaultLimit</h3>
<p>The DefaultLimit option sets the default maximum number of rows that can be selected or updated when executing commands. This is a built-in limitation of SharePoint that one needs to take into account when working with the Connector. The default value of this option is zero, which means that the SharePoint default limit is used which is typically 100 rows. In SELECT statements, the maximum value can be overridden by specifying the LIMIT clause in the SQL query. Note that this option also affects UPDATE and DELETE statements. In practice, all UDPATE and DELETE statements that affect multiple rows are preceded by SELECT commands. The below example shows how to set the default row limit to 1000 rows.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>DefaultLimit</strong>=1000;</p>
<hr>
<h3>StrictMode</h3>
<p>With StrictMode option enabled (default), the Connector enforces data validation on all fields when executing commands. The SharePoint Webservice performs some degree of data validation by its own but does <span style="text-decoration: underline;">not</span> always respect all constraints associated to a column. Therefore, the Connector provides additional checks to ensure data integrity and correctness. Two examples of validation constraints are "data is required in this column" and "this column must contain a value between min and max". It is recommended to keep this option enabled, unless you experience preoblems. The following connection string illustrates how to disable strict mode.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>StrictMode</strong>=False;</p>
<hr>
<h3>NoListFilters</h3>
<p>The NoListFilters option tells the Connector to ignore list filters configured in SharePoint when selecting rows. The default value is <strong>False</strong>. This option only has an effect if no WHERE clause is provided in your queries (the WHERE clause overrides any filters by default). There is no specific recommendation for this option, as it will vary depending on your use case. Change this option to suit your needs.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>NoListFilters</strong>=True;</p>
<hr>
<h3>ExpandUserFields</h3>
<p>The ExpandUserFields option implements a SharePoint Webservice attribute that controls how much information is included in user columns. The default value is <strong>False</strong>, indicating that only ID is displayed. Setting this option to true, includes the user's login name, e-mail address, Session Initiation Protocol (SIP) address and title. Modify this option when needed.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong><span>ExpandUserFields</span></strong>=True;</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="the-connection-string-performance"><i>/3_5/programming/the-connection-string/performance</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Performance</h1>

            
  
  <p>The Camelot .NET Connector has been optimized to add minimal overhead compared to working with the SharePoint Webservice. It is however important to understand some of the limitations related to the underlying HTTP binding used to send SOAP messages and how to tune the performance if needed. There are a few connection string options available for this purpose which will be handled in this section.</p>
<hr>
<h3>MaxReceivedMessageSize</h3>
<p><span>This option sets the maximum size, in bytes, for SOAP messages that can be received by the underlying connection to SharePoint. This value is bound to the amount of memory allocated for each message. The default value is <strong>524 288 bytes</strong>. If the size of a message exceeds the maximum value, it will cause an exception of type <em>System.ServiceModel.CommunicationException</em>. This can be overcome by either increasing the maximum value, or limiting the number of data rows received from SharePoint when executing SELECT statements. The following example doubles the maximum received message size.</span></p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>MaxReceivedMessageSize</strong>=1048576;</p>
<hr>
<h3>MaxBytesPerRead</h3>
<p>The MaxBytesPerRead option controls the quantity of data that is received for each read. In practice, it prevents DOS attacks by limiting the size of XML start tags because the entire tag needs to be buffered to be processed. The default value is <strong>32 768</strong> bytes and should rarely need to be modified. However, if you SELECT columns that contain large data, you may need to use this option. <span>The following example doubles the maximum bytes per read.</span></p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>MaxReceivedMessageSize</strong>=65536;</p>
<hr>
<h3>CacheTimeOut</h3>
<p><span>In order to improve the overall performance of subsequent command executions, the Connector implements a cache mechanism to keep frequently accessed list schemas in memory. The CacheTimeOut option is used to limit the maximum time in seconds that a schema is hold in the cache. There is however a limit on how many schemas that can be cached to keep memory balanced. The default value for the CacheTimeOut option is <strong>30 seconds</strong>. Set this value to -1 <span>as in the example </span>to keep schemas cached as long as frequently used.</span></p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong><span>CacheTimeOut</span></strong>=-1;</p>
<hr>
<h3>StreamBuffering</h3>
<p>This option specifies send method for the <a href="#procedures-upload">UPLOAD</a> procedure. When <strong>True</strong> (default), the data is buffered in memory so it is ready to be resent in the event of redirections or authentication requests. Setting this value to False can improve application performance but can cause problems if the SharePoint server does not support pre-authentication. It is recommended to set this option to <strong>False</strong> if possible.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>StreamBuffering</strong>=False;</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="the-connection-string-security"><i>/3_5/programming/the-connection-string/security</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Security</h1>

            
  
  <p>This section describes connection string options related to security.</p>
<hr>
<h3>SSL</h3>
<p>The Connector supports ecrypted communication and secure identification of a SharePoint server over HTTPS. <span>HTTPS is highly recommended for sensitive transactions in corporate information systems. </span>HTTPS connection is activated by either setting the <strong>SSL</strong> connection string option to <strong>True</strong> as in the example or prefixing the <strong>Server</strong> option with <strong>https://</strong>.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>SSL</strong>=True;</p>
<hr>
<h3>SSLAcceptAll</h3>
<p><span>By default, the Connector accepts untrusted server certificates, such as self signed certificates. For full security set the SSLAcceptAll</span><span> option to </span><strong>False</strong> in production usage.</p>
<p class="doccode">Server=localhost;User=spuser;Password=12345;<strong>SSL</strong>=True;<span><strong>SSLAcceptAll</strong>=False;</span></p>
<p><span><br></span></p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="programming-executing-commands"><i>/3_5/programming/executing-commands</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Executing commands</h1>

            
  
  <p>This section handles some of the most important use cases for the Camelot .NET Connector.</p>
  
  

        </div><hr/></div><div id="section"><a name="executing-commands-command-types"><i>/3_5/programming/executing-commands/command-types</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Command types</h1>

            
  
  <p>The SharePointCommand is configured using the CommandText property. The CommandText property is handled differently depending of the value of the CommandType property. The Connector supports the following CommandType values:</p>
<ul>
<li><strong>Text (default)</strong>: CommandText contains a SQL text command.</li>
<li><strong>TableDirect:</strong> CommandText contains a named SharePoint list/view.</li>
<li><strong>StoredProcedure:</strong> CommandText contains a named procedure.</li>
</ul>
<p>The default CommandType, <strong>Text</strong> is used to execute typical SQL queries, for example INSERT or UPDATE statements. Some example of this can be found in section <a href="#introduction-sharepointconnection">SharePointConnection</a>.</p>
<p><strong>TableDirect</strong> is used to select all columns from a single list/view, thus assuming that the CommandText property contains a named list/view. This is illustrated by the following code:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>TableDirect</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    try
    {
        Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
        connection.Open();

        using (var command = new SharePointCommand())
        {
            command.Connection = connection;
            command.CommandType = CommandType.TableDirect;
            command.CommandText = &quot;Employees&quot;;
            using (var reader = command.ExecuteReader())
            {
                while (reader.Read())
                {
                    Console.WriteLine(reader[&quot;ID&quot;] + &quot; : &quot; + reader[&quot;Name&quot;]);
                }
            }
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.ToString());
    }
    Console.WriteLine(&quot;Done&quot;);
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
    Try
        Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
        connection.Open()

        Using command = New SharePointCommand()
            command.Connection = connection
            command.CommandType = CommandType.TableDirect
            command.CommandText = &quot;Employees&quot;
            Using reader = command.ExecuteReader()
                While reader.Read()
                    Console.WriteLine(reader(&quot;ID&quot;) + &quot; : &quot; + reader(&quot;Name&quot;))
                End While
            End Using
        End Using
    Catch ex As Exception
        Console.WriteLine(ex.ToString())
    End Try
    Console.WriteLine(&quot;Done&quot;)
End Using</code></pre></div></div>
</div>
<p><strong>StoredProcedure</strong> indicates that CommandText contains a named procedure in the Connector, for example "UPLOAD" or "CREATEFOLDER". This command type requires that parameters are added to the Parameters property, see <a href="#introduction-sharepointparameter">SharePointParameter</a>. For a full description of supported procedures see <a href="#3_5-procedures">Procedures</a>. The following example shows how to use this method.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>StoredProcedure</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    try
    {
        Console.WriteLine(&quot;Connecting to SharePoint...&quot;);
        connection.Open();

        using (var command = new SharePointCommand())
        {
            command.Connection = connection;
            command.CommandType = CommandType.StoredProcedure;
            command.CommandText = &quot;download&quot;;

            command.Parameters.Add(&quot;@listname&quot;, &quot;shared documents&quot;);
            command.Parameters.Add(&quot;@file&quot;, &quot;mydocument.docx&quot;);

            var data = command.ExecuteScalar();
            if (data != null)
                System.IO.File.WriteAllBytes(@&quot;c:\mydocument.docx&quot;, (byte[])data);
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.ToString());
    }
    Console.WriteLine(&quot;Done&quot;);
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
    Try
        Console.WriteLine(&quot;Connecting to SharePoint...&quot;)
        connection.Open()

        Using command = New SharePointCommand()
            command.Connection = connection
            command.CommandType = CommandType.StoredProcedure
            command.CommandText = &quot;download&quot;

            command.Parameters.Add(&quot;@listname&quot;, &quot;shared documents&quot;)
            command.Parameters.Add(&quot;@file&quot;, &quot;mydocument.docx&quot;)

            Dim data = command.ExecuteScalar()
            If data IsNot Nothing Then
                System.IO.File.WriteAllBytes(&quot;c:\mydocument.docx&quot;, DirectCast(data, Byte()))
            End If
        End Using
    Catch ex As Exception
        Console.WriteLine(ex.ToString())
    End Try
    Console.WriteLine(&quot;Done&quot;)
End Using</code></pre></div></div>
</div>
<p class="docnote"><strong>Note!</strong> When using CommandType StoredProcedure, it is important that all parameters of the procedure are added in correct order, independent of the parameter names that you choose.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="executing-commands-last-inserted-id"><i>/3_5/programming/executing-commands/last-inserted-id</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Last inserted id</h1>

            
  
  <p>The <strong>LastInsertedId</strong> property of the <a href="#introduction-sharepointcommand">SharePointCommand</a> class offers a simple way to retrieve the auto generated ID of an inserted row. The method returns the last generated ID that was set by the most recent SELECT or CALL statement to a list or document library. You can you also retrieve this value via SQL through the <a href="#sql-statement-syntax-last_insert_id()"><strong>LAST_INSERT_ID()</strong></a> function.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO employees (name) VALUES (&#39;Steve Watson&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Steve&#39;s ID is:&quot; + command.LastInsertedId);
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;INSERT INTO employees (name) VALUES (&#39;Steve Watson&#39;)&quot;, connection)
		command.ExecuteNonQuery()
		Console.WriteLine(&quot;Steve&#39;s ID is:&quot; &amp; Convert.ToString(command.LastInsertedId))
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="executing-commands-last-records-affected"><i>/3_5/programming/executing-commands/last-records-affected</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Last records affected</h1>

            
  
  <p>The <strong>LastRecordsAffected</strong> property of the <a href="#introduction-sharepointcommand">SharePointCommand</a> class can be called to retrieve the number of rows inserted, updated, deleted or selected by the last executed command. This is illustrated in the next example.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE employees SET role = &#39;System Developer&#39; WHERE role = &#39;Code Monkey&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Number of rows updated:&quot; + command.LastRecordsAffected);

    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE employees SET role = &#39;System Developer&#39; WHERE role = &#39;Code Monkey&#39;&quot;, connection)
		command.ExecuteNonQuery()
		Console.WriteLine(&quot;Number of rows updated:&quot; &amp; Convert.ToString(command.LastRecordsAffected))
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="executing-commands-change-database"><i>/3_5/programming/executing-commands/change-database</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Change database</h1>

            
  
  <p>You can use the <strong>ChangeDatabase</strong> method of the <a href="#introduction-sharepointconnection">SharePointConnection</a> class to change site after the connection has been opened. After changing site, all subsequent queries are executed on the new site. The same can be accomplished with the <a href="#sql-statement-syntax-use">USE</a> command statement.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    connection.ChangeDatabase(@&quot;Site/SubSite&quot;);
    using (var command = new SharePointCommand(@&quot;UPDATE customers SET Active = True&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	connection.ChangeDatabase(&quot;Site/SubSite&quot;)
	Using command = New SharePointCommand(&quot;UPDATE customers SET Active = True&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="executing-commands-helper-class"><i>/3_5/programming/executing-commands/helper-class</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Helper class</h1>

            
  
  <p>The Camelot .NET Connector provides a Helper class for executing quick commands. The class contains some static methods that takes care of the <a href="#introduction-sharepointconnection">SharePointConnection</a> and <a href="#introduction-sharepointcommand">SharePointCommand</a> objects. It is not recommended to use the these methods <span class="tyda_entry_base">excessively since a new connection will be opened each time but for smaller applications it can be quite useful. The following examples shows how to use the helper methods.</span></p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteDataTable</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
var data = Helper.ExecuteDataTable(&quot;SELECT * FROM Customers&quot;, connectionString);</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Dim data = Helper.ExecuteDataTable(&quot;SELECT * FROM Customers&quot;, connectionString)</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteNonQuery</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
Helper.ExecuteNonQuery(&quot;UPDATE customers SET Active = True&quot;, connectionString);</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Helper.ExecuteNonQuery(&quot;UPDATE customers SET Active = True&quot;, connectionString)</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ExecuteScalar</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
var maxId = Helper.ExecuteScalar(&quot;SELECT ID FROM Customers ORDER BY ID DESC&quot;, connectionString);</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
var maxId = Helper.ExecuteScalar(&quot;SELECT ID FROM Customers ORDER BY ID DESC&quot;, connectionString);</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="executing-commands-strings-and-escaping"><i>/3_5/programming/executing-commands/strings-and-escaping</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Strings and escaping</h1>

            
  
  <p><span>In SQL statements, l</span>iteral strings are enclosed within single quote (') characters.</p>
<p>Example:</p>
<p class="doccode">&gt; SELECT * FROM `Colors` WHERE Title = <strong>'Red'</strong></p>
<p>In the SQL language, certain characters have special meaning. When writing application programs, any string that might contain any of these special characters must be properly escaped before the string is used as a data value in an SQL statement that is sent to the Connector. <span>The escape sequence begins with a backslash (\) character, known as the escape character. The Connector recognizes the escape sequences shown below.</span></p>
<ul>
<li><strong>\'</strong> - Single quote (') character</li>
<li><strong>\\</strong> - Backslash (\\) character</li>
</ul>
<p>Example: The string <strong>This is color 'Red'</strong> must be escaped because it contains special characters.</p>
<p class="doccode">&gt; SELECT * FROM `Colors` WHERE Description = <strong>'<span>This is color \'Red\'</span>'</strong></p>
<p>There are two ways to ensure that strings are escaped correctly.</p>
<ul>
<li>Process the string with a function that escapes the special characters. The Connector provides a simple helper method called <strong>SqlEscape</strong> that can be used.</li>
</ul>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>
var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    var escapedString = Helper.SqlEscape(@&quot;This is color &#39;Red&#39;&quot;);
    using (var command = new SharePointCommand(@&quot; SELECT * FROM `Colors` WHERE Description = &#39;&quot; + escapedString + &quot;&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Dim escapedString = Helper.SqlEscape(&quot;This is color &#39;Red&#39;&quot;)
	Using command = New SharePointCommand(&quot; SELECT * FROM `Colors` WHERE Description = &#39;&quot; &amp; Convert.ToString(escapedString) &amp; &quot;&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
<ul>
<li>Use the <a href="#introduction-sharepointparameter">SharePointParameter</a> to send string values with the SQL command.</li>
</ul>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot; SELECT * FROM `Colors` WHERE Description = @description&quot;, connection))
    {
        command.Parameters.Add(&quot;@description&quot;, &quot;This is color &#39;Red&#39;&quot;);
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot; SELECT * FROM `Colors` WHERE Description = @description&quot;, connection)
		command.Parameters.Add(&quot;@description&quot;, &quot;This is color &#39;Red&#39;&quot;)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="programming-data-types"><i>/3_5/programming/data-types</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Data types</h1>

            
  
  <p>The Camelot .NET Connector supports all major data types that can be used in SharePoint list columns. SharePoint has a quite different way of naming types than one would be used to as a programmer. Knowing about these types is important to make development more straight forward and also helps understanding the data architecture in SharePoint. This chapter gives an overview of the most common SharePoint data types and explains some of the associated attributes. For more information see <a href="#reference-column-types">Column Types</a>.</p>
<p>The list schema contains information about all columns in a given SharePoint list or view. Schemas are retrieved through the <a href="#sql-statement-syntax-show-columns">SHOW COLUMNS</a> command. The <strong>Type</strong> attribute in the schema indicates the SharePoint data type for each column.</p>
  
  

        </div><hr/></div><div id="section"><a name="data-types-guid"><i>/2_0/programming/data-types/guid</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>GUID</h1>

                                
  
  <p>The <strong>GUID</strong> (Globally Unique Identifier) data type is commonly used in SharePoint to uniquely identify lists, views, columns and even list items. The value is <span>represented as a 32-character hexadecimal string</span>, for example {03e45e84-1992-4d42-9116-26f756012634}. This type corresponds to the Guid structure in .NET.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>GUID select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT ID, Guid FROM Employees&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;ID&quot;] + &quot;, &quot; + ((Guid)reader[&quot;Guid&quot;]).ToString());
           }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT ID, Guid FROM Employees&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;ID&quot;) + &quot;, &quot; &amp; DirectCast(reader(&quot;Guid&quot;), Guid).ToString())
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-counter"><i>/2_0/programming/data-types/counter</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Counter</h1>

                                
  
  <p>The <strong>Counter</strong> data type in generally only used by ID columns. This column type is represented by a 32-bit signed .NET Integer (Int32) and its value is automatically incremented for every row added to the list. Therefore, these columns are always marked as ReadOnly in the list schema. The auto incremented ID for an inserted row can be retrieved through the <a href="#executing-commands-last-inserted-id">LastInsertedId</a> property of the SharePointCommand class.</p>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-boolean"><i>/2_0/programming/data-types/boolean</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Boolean</h1>

                                
  
  <p>The <strong>Boolean</strong> data type (Yes/No column) corresponds to the .NET Boolean type. It is typically edited using a check box control. Accepted values when updating columns of this data type are True, False, 1 or 0.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Boolean select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Active FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; : &quot; + ((bool)reader[&quot;Active&quot;] ? &quot;Active&quot; : &quot;Inactive&quot;));
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Active FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; : &quot; &amp; (If(CBool(reader(&quot;Active&quot;)), &quot;Active&quot;, &quot;Inactive&quot;)))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Boolean update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Active = True WHERE Name = &#39;Steve Watson&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Active = True WHERE Name = &#39;Steve Watson&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-datetime"><i>/2_0/programming/data-types/datetime</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>DateTime</h1>

                                
  
  <p>The <strong>DateTime</strong> data type (Date and Time column) corresponds to the .NET DateTime structure. The <strong>Format</strong> attribute in the list schema indicates whether a column takes a date only (<em>DateOnly</em>) or both date and time (<em>DateTime</em>).</p>
<p>The following ISO 8601 date time formats are accepted:</p>
<ul>
<li>yyyy-MM-ddTHH:mm:ssZ (UTC)</li>
<li>yyyy-MM-dd</li>
<li>yyyy-MM-dd HH:mm:ss</li>
<li>yyyyMMdd</li>
<li>yyyyMMddHHmmss</li>
</ul>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>DateTime select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, EmploymentDate FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; : &quot; + ((DateTime)reader[&quot;EmploymentDate&quot;]).ToString(&quot;yyyy-MM-dd&quot;));
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, EmploymentDate FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; : &quot; &amp; DirectCast(reader(&quot;EmploymentDate&quot;), DateTime).ToString(&quot;yyyy-MM-dd&quot;))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>DateTime update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET EmploymentDate = &#39;2010-09-11&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET EmploymentDate = &#39;2010-09-11&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
<p>The <strong>NOW()</strong> and <strong>TODAY()</strong> functions can be used to query or update fields of type <em>DateTime</em>. These functions are also described under <a href="#sql-statement-syntax-operators-and-functions">Operators and functions.</a></p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>DateTime TODAY example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, EmploymentDate FROM Employees WHERE EmploymentDate = TODAY()&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; was employed today&quot;);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, EmploymentDate FROM Employees WHERE EmploymentDate = TODAY()&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; was employed today&quot;)
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>DateTime NOW example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET EmploymentDate = NOW() WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET EmploymentDate = NOW() WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-integer"><i>/2_0/programming/data-types/integer</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Integer</h1>

                                
  
  <p>The <strong>Integer</strong> data type represents a 32-bit signed .NET Integer (Int32). This type is commonly used for internal SharePoint columns. Custom integer columns are typically created as <strong>Number</strong> columns with zero decimal places. The <strong>Max</strong> and <strong>Min</strong> attributes in the list schema can be used with this column type.</p>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-number-currency"><i>/2_0/programming/data-types/number-currency</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Number / Currency</h1>

                                
  
  <p>The <strong>Number</strong> and <strong>Currency</strong> data types are signed floating point numbers that correspond to the .NET Double type. The <strong>Decimals</strong> attribute in the list schema indicates the number of decimal places allowed for values in these columns. The <strong>Percentage</strong> attribute is a boolean indicating if values should be displayed as percentage (the value multiplied by 100 with a percentage sign appended). In this case, the number of decimal places mean after the multiplication. Furthermore, the <strong>Max</strong>, <strong>Min</strong>, <strong>Div</strong> and <strong>Mult</strong> attributes can be used on these column types. For Currency columns, the format and currency symbol is given by the <strong>LCID</strong> (Local Identifier) attribute.</p>
<p class="docnote"><strong>Note</strong>: The Connector parses all string numerics using dot (.) as decimal point. It is up to the application to print numeric data types in this form when building the SQL query.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Currency select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Salary FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; earns &#163;&quot; + (double)reader[&quot;Salary&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Salary FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; earns &#163;&quot; &amp; CDbl(reader(&quot;Salary&quot;)))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Currency update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Salary = 3250.50 WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Salary = 3250.50 WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-text"><i>/2_0/programming/data-types/text</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Text</h1>

                                
  
  <p>The <strong>Text</strong> data type represents a single line of text. The maximum length in characters is determined by the <strong>MaxLength</strong> attribute in the list schema. With <strong>StrictMode</strong> option enabled, The Connector will throw an exception when executing commands if the text length exceeds the maximum length.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Text select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Email FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has email address &quot; + (string)reader[&quot;Email&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Email FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has email address &quot; &amp; DirectCast(reader(&quot;Email&quot;), String))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Text update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Email = &#39;steve.watson@bendsoft.com&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Email = &#39;steve.watson@bendsoft.com&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-note"><i>/2_0/programming/data-types/note</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Note</h1>

                                
  
  <p>The <strong>Note</strong> data type represents multiple lines of text. This field is not sortable. The <strong>RichText</strong> (boolean) attribute in the list schema indicates if the column accepts rich text formatting. In addition, the <strong>RichTextMode</strong> attribute must be set to <strong>FullHtml</strong> for enhanced rich text which includes images and links. The simpler mode only accepts rich text with bold, italics and text alignments. The <strong>NumLines</strong> attribute specifies the number of lines that should be displayed in text input but does not control the text length in any way.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Note update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Note = &#39;&lt;b&gt;Headline&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;&lt;i&gt;Some text...&lt;/i&gt;&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Note = &#39;&lt;b&gt;Headline&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;&lt;i&gt;Some text...&lt;/i&gt;&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-url"><i>/2_0/programming/data-types/url</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>URL</h1>

                                
  
  <p>The <strong>URL</strong> data type corresponds to a single line of text and is used to display a free form hyperlink or an image. The URL string consists of an address and a title separated by a comma. The column can also be updated without providing a title, in which case the title will be the same as the address. The expected content is given by the <strong>Format</strong> attribute in the list schema that shows either <strong>HyperLink</strong> or <strong>Image</strong>.</p>
<p class="docnote"><strong>Note</strong>: SharePoint only allows absolute paths starting with <strong>http://</strong>, <strong>https://</strong> or <strong>ftp://</strong> or relative paths starting with a single forward slash.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>URL select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, UserUrl FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has profile at &quot; + (string)reader[&quot;UserUrl&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, UserUrl FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has profile at &quot; &amp; DirectCast(reader(&quot;UserUrl&quot;), String))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>URL update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET UserUrl = &#39;/SiteDirectory/_layouts/userdisp.aspx?ID=16&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET UserUrl = &#39;/SiteDirectory/_layouts/userdisp.aspx?ID=16&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-choice-multichoice"><i>/2_0/programming/data-types/choice-multichoice</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Choice / MultiChoice</h1>

                                
  
  <p>The <strong>Choice</strong> and <strong>MultiChoice</strong> data types define a fixed set of values that can be assigned to a column. The difference between the two is that the MultiChoice type allows multiple values while the Choice type only takes a single value. Therefore, the Choice type is represented by a .NET String while the MultiChoice type is represented by a String array. The possible values for a column is given by the <strong>EnumValues</strong> attribute in the list schema. In <strong>StrictMode</strong>, the Connector always validates that the value is within the range of possible values.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>MultiChoice select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Skills FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has the following skills: &quot;);
                foreach (var skill in (string[])reader[&quot;Skills&quot;])
                    Console.WriteLine(skill);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Skills FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has the following skills: &quot;)
				For Each skill As var In DirectCast(reader(&quot;Skills&quot;), String())
					Console.WriteLine(skill)
				Next
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>MultiChoice update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Skills = &#39;Scrum, C#.NET, VB.NET, PHP, MySQL&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Skills = &#39;Scrum, C#.NET, VB.NET, PHP, MySQL&#39; WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-lookup-lookupmulti"><i>/2_0/programming/data-types/lookup-lookupmulti</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Lookup / LookupMulti</h1>

                                
  
  <p>The <strong>Lookup</strong> and <strong>LookupMulti</strong> data types define a relationship between two lists similar to references in relational databases. The lookup column retrieves or "looks up" one or more values from a second list and displays various data from matching rows. There are two types of lookup columns that you can create, a lookup column with an enforced relationship (cascade and restrict delete) and a lookup column with an unenforced relationship.</p>
<p>The <strong>List</strong> attribute in the list schema gives the name of the referenced list and the <strong>FieldRef</strong> attribute gives the name of the foreign column, typically the ID column. This is the column displayed by the Connector.</p>
<p>The <strong>ShowField</strong> attribute gives the name of a foreign column that should be displayed in list views. Lookup columns can be queried either through the <strong>FieldRef</strong> column or the <strong>ShowField</strong> column. Updates on these columns must use values from <strong>FieldRef</strong>.</p>
<p>The Lookup type is represented by a .NET Int32 while the LookupMulti type is represented by a Int32 array. Columns can only be updated with values that exist in the referenced list.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Lookup select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Department FROM Employees&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; belongs to department id &quot; + (Int32)reader[&quot;Department&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Department FROM Employees&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine((reader(&quot;Name&quot;).ToString() &amp; &quot; belongs to department id &quot;) + DirectCast(reader(&quot;Department&quot;), Int32))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Lookup update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET Department = 3 WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET Department = 3 WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
<p>Introduced with Camelot .NET Connector 2.0, you can use JOIN syntax to select arbitrary columns from any other list and of course this can be useful for Lookup columns.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Lookup select using join example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Employees.Name AS Name, Departments.Title AS Department FROM Employees INNER JOIN Departments ON Employees.Department = Department.ID&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; belongs to department name &quot; + (string)reader[&quot;Department&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Employees.Name AS Name, Departments.Title AS Department FROM Employees INNER JOIN Departments ON Employees.Department = Department.ID&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; belongs to department name &quot; &amp; DirectCast(reader(&quot;Department&quot;), String))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p>The <strong>SHOWFIELD()</strong> function, also described under <a href="#sql-statement-syntax-operators-and-functions">Operators and functions</a>, can be applied on columns of these types to return the <em>ShowField</em> value from the relation.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Lookup SHOWFIELD example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, SHOWFIELD(Department) AS DepartmentName FROM Employees&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; belongs to department name &quot; + (string)reader[&quot;DepartmentName&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, SHOWFIELD(Department) AS DepartmentName FROM Employees&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; belongs to department name &quot; &amp; DirectCast(reader(&quot;DepartmentName&quot;), String))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p>The <strong>LOOKUP()</strong> function<span>, also described under </span><a href="#sql-statement-syntax-operators-and-functions">Operators and functions</a><span>,</span> can be applied on fields of these types to return both the <em>FieldRef</em> value and the <em>ShowField</em> value from the relation separated by ';#'. This is useful when you want to show both links and titles.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Lookup LOOKUP example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, LOOKUP(Department) AS Dep FROM Employees&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; belongs to department id &quot; + ((string)reader[&quot;Dep&quot;]).Split(new string[] { &quot;;#&quot; }, StringSplitOptions.None)[0]);
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; belongs to department name &quot; + ((string)reader[&quot;Dep&quot;]).Split(new string[] { &quot;;#&quot; }, StringSplitOptions.None)[1]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, LOOKUP(Department) AS Dep FROM Employees&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; belongs to department id &quot; &amp; DirectCast(reader(&quot;Dep&quot;), String).Split(New String() {&quot;;#&quot;}, StringSplitOptions.None)(0))
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; belongs to department name &quot; &amp; DirectCast(reader(&quot;Dep&quot;), String).Split(New String() {&quot;;#&quot;}, StringSplitOptions.None)(1))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-user-usermulti"><i>/2_0/programming/data-types/user-usermulti</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>User / UserMulti</h1>

                                
  
  <p>The <strong>User</strong> and <strong>UserMulti</strong> data types are specialized <a href="#data-types-lookup-lookupmulti">Lookup</a> types that define a relationship with the <strong>UserInfo</strong> list in SharePoint. The <strong>List</strong> attribute is <em>UserInfo</em> and the related <strong>ShowField</strong> attribute is <em>ImnName</em>. The UserInfo list is a hidden standard list that stores user information.</p>
<p>The return value for these columns depend on the the connection string option <strong>ExpandUserFields</strong>, described under <a href="#the-connection-string-basic-options">Basic options</a>.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>User select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT User FROM Employees&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has user id &quot; + (Int32)reader[&quot;User&quot;]);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT User FROM Employees&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine((reader(&quot;Name&quot;).ToString() &amp; &quot; has user id &quot;) + DirectCast(reader(&quot;User&quot;), Int32))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p>The <strong>USERID()</strong> function<span>, also described under </span><a href="#sql-statement-syntax-operators-and-functions">Operators and functions</a><span>,</span> can be used to query or update fields of type <em>User</em> or <em>UserMulti</em>. This function has the meaning of current user.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>User USERID example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT User FROM Employees WHERE User = USERID()&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            if (reader.Read())
                Console.WriteLine(&quot;My user id is &quot; + (Int32)reader[&quot;User&quot;]);
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT User FROM Employees WHERE User = USERID()&quot;, connection)
		Using reader = command.ExecuteReader()
			If reader.Read() Then
				Console.WriteLine(&quot;My user id is &quot; + DirectCast(reader(&quot;User&quot;), Int32))
			End If
		End Using
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-calculated"><i>/2_0/programming/data-types/calculated</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Calculated</h1>

                                
  
  <p>The <strong>Calculated</strong> data type are used on columns whose value is calculated based on values in other columns, thus colums of this type are always marked as <strong>ReadOnly</strong> in the list schema. The values in these columns are represented by the .NET Object type which in reality is any of Text, Boolean, Number of DateTime.</p>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-computed"><i>/2_0/programming/data-types/computed</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Computed</h1>

                                
  
  <p>The <strong>Computed</strong> type are normally used by internal columns that depends on another column for its content. For example, it is often seen in the <em>LinkTitle</em> column, which displays the same as the <em>Title</em> column surrounded by a a hyperlink.</p>
<p>The <strong>HTTPGET()</strong> function can be applied to columns of Computed type to retrieve content from URL's that are stored in such columns. The function returns a .NET Byte array. It can be used to download files from document libraries as demonstrated below.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Computed HTTPGET example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Title, HTTPGET(EncodedAbsUrl) AS Data FROM `Shared Documents`&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                var fileName = (string)reader[&quot;Title&quot;];
                var data = (byte[])reader[&quot;Data&quot;];

                Console.WriteLine(&quot;Writing file: &quot; + fileName);
                System.IO.File.WriteAllBytes(@&quot;C:\&quot; + fileName, data);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Title, HTTPGET(EncodedAbsUrl) AS Data FROM `Shared Documents`&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Dim fileName = DirectCast(reader(&quot;Title&quot;), String)
				Dim data = DirectCast(reader(&quot;Data&quot;), Byte())

				Console.WriteLine(&quot;Writing file: &quot; &amp; fileName)
				System.IO.File.WriteAllBytes(&quot;C:\&quot; &amp; fileName, data)
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-attachments"><i>/2_0/programming/data-types/attachments</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Attachments</h1>

                                
  
  <p>The <strong>Attachments</strong> data type is a special .NET Boolean column that indicates if attachments have been added to the list item. Every SharePoint list has a built-in column with the very same name that can be selected. This column is useful to avoid unnecessary queries for attachment data. In SharePoint, this column typically displays a clip for every row that has attachments. This column is <strong>ReadOnly</strong>.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Attachments select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Name, Attachments FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has attachments: &quot; + ((bool)reader[&quot;Attachments&quot;] ? &quot;Yes&quot; : &quot;No&quot;));
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT Name, Attachments FROM Employees ORDER BY Name&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has attachments: &quot; &amp; (If(CBool(reader(&quot;Attachments&quot;)), &quot;Yes&quot;, &quot;No&quot;)))
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-binary"><i>/2_0/programming/data-types/binary</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Binary</h1>

                                
  
  <p>The <strong>Binary</strong> data type is mostly used when querying attachments or documents from SharePoint lists and libraries. This column type is represented by a .NET Byte array. It can be updated giving a string value, in which case the string is converted to a UTF-8 encoded Byte array.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Binary attachment select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT FileName, Data FROM Employees.Attachments WHERE ItemID = 16&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                var fileName = (string)reader[&quot;FileName&quot;];
                var data = (byte[])reader[&quot;Data&quot;];

                Console.WriteLine(&quot;Writing file: &quot; + fileName);
                System.IO.File.WriteAllBytes(@&quot;C:\&quot; + fileName, data);
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;SELECT FileName, Data FROM Employees.Attachments WHERE ItemID = 16&quot;, connection)
		Using reader = command.ExecuteReader()
			While reader.Read()
				Dim fileName = DirectCast(reader(&quot;FileName&quot;), String)
				Dim data = DirectCast(reader(&quot;Data&quot;), Byte())

				Console.WriteLine(&quot;Writing file: &quot; &amp; fileName)
				System.IO.File.WriteAllBytes(&quot;C:\&quot; &amp; fileName, data)
			End While
		End Using
	End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Binary attachment update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO Employees.Attachments (ItemID, FileName, Data) VALUES (16, &#39;Curriculum_Vitae.doc&#39;, @doc)&quot;, connection))
    {
        var data = System.IO.File.ReadAllBytes(@&quot;C:\Curriculum_Vitae.doc&quot;);
        command.Parameters.Add(&quot;@doc&quot;, data);
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;INSERT INTO Employees.Attachments (ItemID, FileName, Data) VALUES (16, &#39;Curriculum_Vitae.doc&#39;, @doc)&quot;, connection)
		Dim data = System.IO.File.ReadAllBytes(&quot;C:\Curriculum_Vitae.doc&quot;)
		command.Parameters.Add(&quot;@doc&quot;, data)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="data-types-modstat"><i>/2_0/programming/data-types/modstat</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>ModStat</h1>

                                
  
  <p>The <strong>ModStat</strong> data type provides content approval status and is represented by a .NET Integer (Int32). Possible values are Approved (0), Rejected (1) and Pending (2). The content approval feature can be activated per list and means that new items or modified items remain in draft state until they have been approved. The status is queried through a built-in column named <em>_ModerationStatus</em>. The Connector allows you to programmatically modify the approval status, given that the user has sufficient rights to do so.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ModStat select example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT _ModerationStatus FROM Employees ORDER BY Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                switch ((Int32)reader[&quot;_ModerationStatus&quot;])
                {
                    case 0:
                        Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has approval status: Approved&quot;);
                        break;
                    case 1:
                        Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has approval status: Rejected&quot;);
                        break;
                    case 2:
                        Console.WriteLine(reader[&quot;Name&quot;].ToString() + &quot; has approval status: Pending&quot;);
                        break;
                }
            }
        }
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
    connection.Open()
    Using command = New SharePointCommand(&quot;SELECT _ModerationStatus FROM Employees ORDER BY Name&quot;, connection)
        Using reader = command.ExecuteReader()
            While reader.Read()
                Select Case DirectCast(reader(&quot;_ModerationStatus&quot;), Int32)
                    Case 0
                        Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has approval status: Approved&quot;)
                    Case 1
                        Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has approval status: Rejected&quot;)
                    Case 2
                        Console.WriteLine(reader(&quot;Name&quot;).ToString() &amp; &quot; has approval status: Pending&quot;)
                End Select
            End While
        End Using
    End Using
End Using</code></pre></div></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>ModStat update example</h4><div class="tabcontrol"><div id="tabs-cs"><pre class="prettyprint" lang="cs"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;UPDATE Employees SET _ModerationStatus = 0 WHERE Name = &#39;Steve Watson&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div><div id="tabs-vbnet"><pre class="prettyprint lang-vb.net" lang="vb.net"><code>Dim connectionString = &quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;
Using connection = New SharePointConnection(connectionString)
	connection.Open()
	Using command = New SharePointCommand(&quot;UPDATE Employees SET _ModerationStatus = 0 WHERE Name = &#39;Steve Watson&#39;&quot;, connection)
		command.ExecuteNonQuery()
	End Using
End Using</code></pre></div></div>
</div>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="programming-tutorials"><i>/3_5/programming/tutorials</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Tutorials</h1>

            
  
  <p>This section is dedicated to various tutorials that shows more specific development using the Camelot .NET Connector.</p>
  
  

        </div><hr/></div><div id="section"><a name="tutorials-aspnet"><i>/2_0/programming/tutorials/aspnet</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>ASP.NET</h1>

                                
  
  <p>In this tutorial we will show you how to use the Camelot .NET Connector to build a simple external ASP.NET web application in Visual Studio 2010. In the tutorial we will query a simple list in SharePoint for color information and display the result in the ASP.NET website.</p>
<h3>Preparation</h3>
<ol class="doclist">
<li>Create a new custom list in SharePoint and name it <strong>Colors</strong>.</li>
<li>Create an additional text column and name it <strong>HEX</strong>. This column stores the hexadecimal color code associated with each color. Ensure that <strong>Add to default view</strong> is checked.</li>
<li>Now add a few colors.</li>
</ol>

<h3> Create Visual Studio project</h3>
<ol class="doclist"><ol>
<li>Open Visual Studio 2010</li>
<li>Create a new project<br>
<ul>
<li>Select File -&gt; New Project</li>
<li>Select <strong>C#</strong> under <strong>Installed Templates</strong></li>
<li>Select <strong><em>ASP.NET Web Application</em></strong></li>
<li>Select runtime version <strong><em>.NET Framework 3.5</em></strong><em> or <strong>4.0</strong></em></li>
<li>Name your project solution "CamelotSharePointCMS" [Click OK]</li>
</ul>
</li>
<li>Add reference to Camelot.SharePointConnector.dll<br>
<ul>
<li>Right-click on <strong>CamelotSharePointCMS </strong>in the Solution Explorer [Click <strong>Add Reference</strong>]</li>
<li>Go to the .NET tab</li>
<li>Locate <strong>Camelot.SharePointConnector.dll </strong>for Framework 2 or 4 [Click OK]</li>
</ul>
</li>
</ol></ol>
<h3>Replace the code</h3>
<p>Replace the content of <strong>default.aspx</strong> with the following code. In this file we will only add some minor styling and a panel control where our content will go.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Default.aspx</h4><div><pre class="prettyprint" lang="html"><code>&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Default.aspx.cs&quot; Inherits=&quot;CamelotSharePointCMS._Default&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head id=&quot;Head&quot; runat=&quot;server&quot;&gt;
    &lt;title&gt;Using SharePoint as a simple CMS&lt;/title&gt;
    &lt;style type=&quot;text/css&quot;&gt;
        input {
            display: block;
            margin-bottom: 2px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;Form&quot; runat=&quot;server&quot;&gt;
    &lt;div&gt;
        &lt;asp:Panel ID=&quot;Colors&quot; runat=&quot;server&quot; /&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>
<p>Replace the content of <strong>default.aspx.cs</strong> with the following code. In the code behind file we will query the Colors list and display our colors in simple textbox controls.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Default.aspx.cs</h4><div><pre class="prettyprint" lang="vb.net"><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Configuration;
using Camelot.SharePointConnector.Data;
using System.Data;

namespace CamelotSharePointCMS
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            var data = new DataTable();
            
            using (var connection = new SharePointConnection(ConfigurationManager.ConnectionStrings[&quot;sharepoint&quot;].ConnectionString))
            {
                using (var adapter = new SharePointDataAdapter(&quot;SELECT Title, HEX FROM `Colors`&quot;, connection))
                {
                    adapter.Fill(data);
                }
            }

            foreach (DataRow row in data.Rows)
            {
                var colorBox = new TextBox() 
                { 
                    Text = row[&quot;Title&quot;].ToString(), 
                    BackColor =  System.Drawing.ColorTranslator.FromHtml(&quot;#&quot; + row[&quot;HEX&quot;].ToString())
                };
                Colors.Controls.Add(colorBox);
            }
        }
    }
}</code></pre></div>
</div>
<p>The last thing we need to do is to add the connection string "sharepoint" to the <strong>web.config</strong>. Locate the section connectionStrings and replace with the following. Modify <strong>Server</strong>, <strong>Username </strong>and <strong>Password </strong>to match your SharePoint server and possibly also <strong>Database</strong> if the Colors list was not created in the root site.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Web.config</h4><div><pre class="prettyprint" lang="xml"><code>&lt;connectionStrings&gt;
	&lt;add name=&quot;sharepoint&quot; connectionString=&quot;Server=sharepointserver.com;DataBase=;User=username;Password=password;Authentication=Ntlm;TimeOut=10&quot; providerName=&quot;Camelot.SharePointProvider&quot; /&gt;
&lt;/connectionStrings&gt;</code></pre></div>
</div>
<h3>Test the application</h3>
<p>Now you should be ready to test your ASP.NET web site and see the results.</p>
<ol class="doclist">
<li>Right-click on <strong>default.aspx</strong> in the Solution Explorer [Click <strong>View in Browser</strong>]</li>
<li>The page will now be opened in your web browser and show your colors.</li>
</ol>
<p></p>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><div id="section"><a name="tutorials-download-documents"><i>/2_0/programming/tutorials/download-documents</i></a><div id="rightcontent">                                
                                
  
                                                              
                              
                                
                                 
  <h1>Download documents</h1>

                                
  
  <p>In this tutorial we will create a simple console application that queries a SharePoint document library for all its documents and folders and then iterates through the results. The entire structure will then be reconstructed on local disk, including empty folders. We will also compare the <em>Modified</em> date of each document with the last write time of the corresponding local file to decided whether a document needs to be updated. This may increase the performance significantly when doing large backups.</p>
<h3>Preparation</h3>
<p>No special preparation required. Just make sure that <strong>Shared Documents</strong> exists on the site.</p>
<h3>Create Visual Studio project</h3>
<ol class="doclist"><ol>
<li>Open Visual Studio 2010</li>
<li>Create a new project<br>
<ul>
<li>Select File -&gt; New Project</li>
<li>Select <strong>C#</strong> under <strong>Installed Templates</strong></li>
<li>Select <strong><em>Console Application</em></strong></li>
<li>Select runtime version <strong><em>.NET Framework 3.5</em></strong><em> or <strong>4.0</strong></em></li>
<li>Name your project solution "DownloadDocumentLibraryExample" [Click OK]</li>
</ul>
</li>
<li>Add reference to Camelot.SharePointConnector.dll<br>
<ul>
<li>Right-click on <strong>DownloadDocumentLibraryExample </strong>in the Solution Explorer [Click <strong>Add Reference</strong>]</li>
<li>Go to the .NET tab</li>
<li>Locate <strong>Camelot.SharePointConnector.dll </strong>for Framework 2 or 4 [Click OK]</li>
</ul>
</li>
</ol></ol>
<h3>Replacing the code</h3>
<p>Open up <strong>Program.cs</strong> and replace the content with the following lines.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Program.cs</h4><div><pre class="prettyprint" lang="c#"><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Camelot.SharePointConnector.Data;
using System.IO;

namespace DownloadDocumentLibraryExample
{
    class Program
    {
        static void Main(string[] args)
        {
            var connectionString = &quot;Server=mysharepointserver.com;Database=;User=user;Password=password;Authentication=Ntlm;TimeOut=60;&quot;;
            var rootFolder = @&quot;c:\documents&quot;;

            var documents = Helper.ExecuteDataTable(&quot;SELECT ServerUrl, Modified, ContentType FROM `Shared Documents`&quot;, connectionString);
            if (documents.Rows.Count &gt; 0)
            {
                foreach (System.Data.DataRow doc in documents.Rows)
                {
                    Console.WriteLine(doc[&quot;ContentType&quot;] + &quot;  &quot; + doc[&quot;ServerUrl&quot;]);

                    using (var connection = new SharePointConnection(connectionString))
                    {
                        connection.Open();

                        switch ((string)doc[&quot;ContentType&quot;])
                        {
                            case &quot;Folder&quot;:
                                if (!Directory.Exists(rootFolder + doc[&quot;ServerUrl&quot;]))
                                    Directory.CreateDirectory(rootFolder + doc[&quot;ServerUrl&quot;]);

                                break;
                            case &quot;Document&quot;:
                                var parentFolder = Directory.GetParent(rootFolder + doc[&quot;ServerUrl&quot;]).ToString();

                                if (!Directory.Exists(parentFolder))
                                    Directory.CreateDirectory(parentFolder);

                                if (!File.Exists(rootFolder + doc[&quot;ServerUrl&quot;]) || File.GetLastWriteTime(rootFolder + doc[&quot;ServerUrl&quot;]) != (DateTime)doc[&quot;Modified&quot;])
                                {
                                    using (var command = new SharePointCommand(&quot;CALL DOWNLOAD(&#39;Shared Documents&#39;, &#39;&quot; + doc[&quot;ServerUrl&quot;] + &quot;&#39;)&quot;, connection))
                                    {
                                        var bytes = (byte[])command.ExecuteScalar();
                                        File.WriteAllBytes(rootFolder + doc[&quot;ServerUrl&quot;], bytes);
                                        File.SetLastWriteTime(rootFolder + doc[&quot;ServerUrl&quot;], (DateTime)doc[&quot;Modified&quot;]);
                                    }
                                }

                                break;
                        }

                    }
                }
            }
            Console.WriteLine(&quot;Complete!&quot;);
            Console.ReadKey();
        }
    }
}</code></pre></div>
</div>
<p>Firstly, we declare our SharePoint connection string required for connecting to the SharePoint server. You will need to modify the connection string in the example according to your configuration. Secondly, we declare a root folder where all documents will be downloaded, e.g. “c:\documents”.</p>
<p>Now we are ready to query the document library. For simplicity in this example, we choose to download the <strong>Shared Documents</strong> library. Our query selects all items in this library returning the <em>ServerUrl</em>, <em>Modified</em> and <em>ContentType</em> columns. The first column indicates the relative path of a document or folder, e.g. “textfile.txt” or “folder1/folder2/textfile.txt”, giving us the structure of the library. It will be printed to the console window. The <em>ContentType</em> can be either “Folder” or “Document”. Note that we use the <a href="#executing-commands-helper-class">ExecuteDataTable</a> method in the Helper class to select directly into a DataTable.</p>
<p>In the next step, we iterate through the items returned by the select query. If the item is of type “Folder”, we simply create the folder under the root folder. If the item is of type “Document”, we first compare the date of any existing file with the SharePoint <em>Modified</em> date to determine if the document has changed since it was last downloaded. If it has, we use the <a href="#procedures-download">DOWNLOAD</a> procedure of the Camelot .NET Connector to fetch the file and then write it to disk.</p>
<h3>Test the application</h3>
<p>Now run the application and see what happens. If everything goes fine and there are documents and/or folders in the library, you should see a list of items as they are being processed. When the application is done you should find the documents in your root folder. If you run the application a second time, you probably notice that documents are not being downloaded again until they have been modified.</p>
<p></p>
  
  <div>
    

<p> </p>
  </div>

                            </div><hr/></div><a name="tutorials-nhibernate"><i style="color:red;">Section unavailable: /3_5/programming/tutorials/nhibernate</i></a><hr/><div id="section"><a name="programming-license-files"><i>/3_5/programming/license-files</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>License files</h1>

            
  
  <p>The Camelot .NET Connector is a licensed software, thus requiring a valid license file on the computer where it is installed. The default license file, when installed by the <a href="#3_5-installation">Camelot License Key Manager</a>, is stored in the computer's <em>ProgramData\BendSoft\</em> as <strong>license_signed.xml</strong>.</p>
<p>Introduced with the Camelot .NET Connector 3.5, the license file can be provided directly via code. This improves interoperability on some platforms and also simplifies deployment of distributed software.</p>
<p class="docnote"><strong>Note!</strong> Bendsoft provides redistributable licenses on demand. Please contact us through our website if you are interested in building redistributable software based on the Camelot .NET Connector.</p>
<p><span class="tyda_entry_base">The following examples shows how to provide your license key using code.</span></p>
<p><span class="tyda_entry_base">Provide the file location of the license file.</span></p>
<p><span class="tyda_entry_base"><div id="ContentPlaceHolderDefault_MainContent_container">
	<div><pre class="prettyprint" lang="vb.net"><code>SharePointConnection.ProvideLicenseFile(@&quot;C:\mylicense.xml&quot;);</code></pre></div>
</div></span></p>
<p><span class="tyda_entry_base"><span class="tyda_entry_base">Provide the raw XML content of the license file. This allows you to bundle the license file in your application.</span></span></p>
<p><span class="tyda_entry_base"><span class="tyda_entry_base"><div id="ContentPlaceHolderDefault_MainContent_container">
	<div><pre class="prettyprint" lang="vb.net"><code>SharePointConnection.ProvideLicenseXml(System.IO.File.ReadAllText(@&quot;C:\mylicense.xml&quot;));</code></pre></div>
</div></span></span></p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-sql-statement-syntax"><i>/3_5/sql-statement-syntax</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SQL statement syntax</h1>

            
  
  <p>This chapter describes the syntax for the SQL statements supported by the Camelot .NET Connector. The subchapters contain code examples that demonstrate how to use the connector to perform various complex tasks.</p>
  
  

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-show-databases"><i>/3_5/sql-statement-syntax/show-databases</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW DATABASES</h1>

            
  
  <p>SHOW DATABASES displays information about subsites of the current site. The result table can be useful in many programming scenarios, such as when iterating through a collection of sites. The <em>SHOW SITES</em> command is a synonym for <em>SHOW DATABASES</em>.</p>
<p>This command always return same columns. For the complete listing see the <a href="#reference-show-databases">SHOW DATABASES reference</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SHOW [ALL] {DATABASES | SITES};</p>
<h2>Code examples</h2>
<p>Get all sites directly beneath the current site and print name and URL.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print sites</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;SHOW DATABASES&quot;, connection))
{
    using (var reader = command.ExecuteReader())
    {
        while (reader.Read())
        {
            Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Url&quot;].ToString());
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Customers                                : http://myspsite.com/customers<br>Economy                                  : http://myspsite.com/economy<br>Marketing                                : http://myspsite.com/marketing<br>Sales                                    : http://myspsite.com/sales</p>
<p>Gets all sites within the current site collection and print name and URL.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print all sites</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;SHOW ALL DATABASES&quot;, connection))
{
    using (var reader = command.ExecuteReader())
    {
        while (reader.Read())
        {
            Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Url&quot;].ToString());
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Home                                     : http://myspsite.com<br>Customers                                : http://myspsite.com/customers<br>Economy                                  : http://myspsite.com/economy<br>Marketing                                : http://myspsite.com/marketing<br>Sales                                    : http://myspsite.com/sales</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-show-tables"><i>/3_5/sql-statement-syntax/show-tables</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW TABLES</h1>

            
  
  <p>SHOW TABLES displays information about all visible lists in the site. The result table provides valuable information that can be useful in many programming scenarios, such as when a list was created, last modified or how many items a list currently contains. The <em>SHOW LISTS</em> command is a synonym for <em>SHOW TABLES</em>.</p>
<p>This command always return same columns. For the complete listing see the <a href="#reference-show-tables">SHOW TABLE reference</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SHOW {TABLES | LISTS};</p>
<p><strong>Code example</strong>: Get all lists and libraries in a site and print name and type. Generic lists have type 0 and document libraries have type 1.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print lists and libraries</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SHOW TABLES&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;BaseType&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Announcements                            : 0<br>Calendar                                 : 0<br>Content type publishing error log        : 0<br>Converted Forms                          : 1<br>Customized Reports                       : 1<br>Form Templates                           : 1<br>Links                                    : 0<br>List Template Gallery                    : 1<br>Master Page Gallery                      : 1<br>Reporting Metadata                       : 0<br>Reporting Templates                      : 1<br>Shared Documents                         : 1<br>Site Assets                              : 1<br>Site Pages                               : 1<br>Solution Gallery                         : 1<br>Style Library                            : 1<br>Tasks                                    : 0<br>TaxonomyHiddenList                       : 0<br>Team Discussion                          : 0<br>Theme Gallery                            : 1<br>User Information List                    : 0<br>Web Part Gallery                         : 1<br>wfpub                                    : 1</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-show-columns"><i>/3_5/sql-statement-syntax/show-columns</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW COLUMNS</h1>

            
  
  <p>SHOW COLUMNS displays information about the columns in a given list. The <em>SHOW FIELDS</em> command is a synonym for <em>SHOW COLUMNS</em>.</p>
<p>This command always return same columns. For the complete listing see the <a href="#reference-show-columns">SHOW COLUMNS reference</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SHOW {COLUMNS | FIELDS} <br> FROM <em><strong>list_name</strong></em> [.{<em><strong>view_name</strong></em> | <em><strong>content_type_name</strong></em> | ALL | ATTACHMENTS}];</p>
<p><strong>Example</strong>: to show columns of list Employees:</p>
<p class="doccode">SHOW COLUMNS FROM Employees</p>
<p><strong>Code example</strong>: Get all columns in the default view of a list and print name and SharePoint type. For the complete listing of possible types see the <a href="#reference-show-columns">SHOW COLUMNS reference</a>.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print list columns</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SHOW COLUMNS FROM Tasks&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Type&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Attachments                              : Attachments<br>DocIcon                                  : Computed<br>LinkTitle                                : Computed<br>AssignedTo                               : User<br>Status                                   : Choice<br>Priority                                 : Choice<br>DueDate                                  : DateTime<br>PercentComplete                          : Number<br>Predecessors                             : LookupMulti</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-show-views"><i>/3_5/sql-statement-syntax/show-views</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW VIEWS</h1>

            
  
  <p>SHOW VIEWS displays information about all views of a given list.</p>
<p>This command always return same columns. For the complete listing see the <a href="#reference-show-views">SHOW VIEWS reference</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SHOW VIEWS FROM <em><strong>list_name</strong></em>;</p>
<p><strong>Example</strong>: to show views of list Employees:</p>
<p class="doccode">SHOW VIEWS FROM Employees</p>
<p><strong>Code example</strong>: Get all views of a list and print display name and a boolean that tells which view is default.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print list views</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SHOW VIEWS FROM Tasks&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                var table = reader.GetSchemaTable();
                Console.WriteLine(reader[&quot;DisplayName&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;DefaultView&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">All Tasks                                : True<br>My Tasks                                 : False<br>Due Today                                : False<br>Active Tasks                             : False<br>By Assigned To                           : False<br>By My Groups                             : False</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-show-contenttypes"><i>/3_5/sql-statement-syntax/show-contenttypes</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW CONTENTTYPES</h1>

            
  
  <p>SHOW CONTENTTYPES displays information about all content types of a given list.</p>
<p>This command always return same columns. For the complete listing see the <a href="#reference-show-contenttypes">SHOW CONTENTTYPES reference</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SHOW CONTENTTYPES FROM <strong><em>list_name</em></strong>;</p>
<p><strong>Example</strong>: to show content types of list Employees:</p>
<p class="doccode">SHOW CONTENTTYPES FROM Employees</p>
<p><strong>Code example</strong>: Get all content types of a list and print name and description.</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print list content types</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SHOW CONTENTTYPES FROM Tasks&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(20) + &quot; : &quot; + reader[&quot;Description&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Task                 : Track a work item that you or your team needs to complete.<br>Folder               : Create a new folder.<br>Summary Task         : Group and describe related tasks that you or your team needs to complete.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-select"><i>/3_5/sql-statement-syntax/select</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SELECT</h1>

            
  
  <p>SELECT is used to retrieve rows from a given list and can be futher specified with view or content type. It is also used to select attachments.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SELECT <br> {<em><strong>select_expression</strong></em> [AS <em><strong>alias_name</strong></em>], ... | * } <br> FROM <em><strong>list_name</strong></em> [.{<em><strong>view_name</strong></em> | <em><strong>content_type_name</strong></em> | ALL | ATTACHMENTS}] [[AS] <em><strong>alias_name</strong></em>] <br> [{INNER JOIN | LEFT JOIN} <em><strong>list_name</strong></em> [[AS] <em><strong>alias_name</strong></em>] ON <em><strong>join_condition</strong></em>] <br> [WHERE <em><strong>where_condition</strong></em>] <br> [GROUP BY {<em><strong>col_name</strong></em> | <em><strong>expression</strong></em>}] <br> [HAVING <em><strong>where_condition</strong></em>] <br> [ORDER BY {<em><strong>col_name</strong></em> | <em><strong>expression</strong></em>} [ASC | DESC], ...] <br> [LIMIT [<em><strong>row_offset</strong></em>,] <em><strong>row_count</strong></em>];</p>
<p>The SELECT statement is used as follows:</p>
<ol class="doclistbullet">
<li>
<p>Each <em>select_expression</em> indicates a column that you want to retrieve. There must be at least on expression here and you can use any of the functions that the connector supports. Alternatively, you can specify an asterisk symbol (*) to select all columns that are visible in the view. If view is not specified, the default view of the list is used. The connector does not permit duplicate column names. That is, there can not be more than one <em>select_expression</em> with the same name. Each selected column can be given an alias using the <em>AS </em>keyword followed by the alias name. The alias is displayed as column name in the result table and can used to reference the column in subsequent clauses, e.g. in the <em>WHERE </em>clause.</p>
<p><strong>Example</strong>: to select all columns from the default view of list <em>Employees</em>:</p>
<p class="doccode">SELECT * FROM Employees</p>
<p><strong>Example</strong>: to select and reference a column with alias:</p>
<p class="doccode">SELECT CONCAT(Lastname, ', ', Firstname) AS Fullname FROM Customers ORDER BY Fullname</p>
<p><strong>Example</strong>: to select the reverse value of the <em>Title</em> column in uppercase and calculate the number of characters:</p>
<p class="doccode">SELECT UCASE(REVERSE(Title)), LENGTH(Title) FROM Employees</p>
<p><strong>Example</strong>: to select the maximum value of the <em>ID</em> column:</p>
<p class="doccode">SELECT MAX(ID) FROM Employees</p>
</li>
<li>
<p>The <em>list_name</em> indicates the list from which to retrieve the rows. Optionally, you can also specify the view or content type that defines a subset of rows and columns. That is, if content type is specified only items of that type is retrieved by the query. If view or content type is not specified, the <em>SELECT</em> statement displays all columns from the default list view. Alternatively, the ALL keyword can be specified to widen the column-set to also include hidden list columns, i.e. columns that are not typically displayed in the SharePoint interface. The selected list can be given an alias using the <em>AS </em>keyword followed by the alias name. The alias name can then be used to reference the list in other clauses.</p>
<p><strong>Example</strong>: to select all columns, including those not visible in default view:</p>
<p class="doccode">SELECT * FROM Employees.ALL</p>
<p class="docnote"><strong>Note</strong>: The ALL keyword, view or content type is only applicable when no specific columns are specified.</p>
<p><strong>Example</strong>: to retrieve rows of content type Item:</p>
<p class="doccode">SELECT * FROM Employees.Item</p>
<p><strong>Example</strong>: to select columns from a list by referencing its alias name:</p>
<p class="doccode">SELECT e.ID, e.Title FROM Employees AS e</p>
</li>
<li>The <em>JOIN </em>clause is used to select data from multiple lists in a single select based on join conditions. The query compares each row of the left side list with each row of the right side list to find all pairs of rows which satisfy the join condition. When the join condition is satisfied, column values from left side list and right side list are combined into a result row. For INNER JOIN, if the join condition evaluates false, the row is not selected. For LEFT JOIN, if the join condition evaluates false, all selected columns from the left side list are returned but with NULL in all selected columns from the right side list. You can use LEFT JOIN to find rows in a list that have no counterpart in another list. The JOIN clause can be used in combination with the WHERE clause. The WHERE condition is always executed after the JOIN condition. Each joined list can be given an alias using the <em>AS </em>keyword followed by the alias name. Column aliases can also be used in the join condition.
<p class="docnote"><strong>Note</strong>: The connector does not permit duplicate column names. If you join two lists that contain equally named columns, it is recommended to use alias (AS) to name the columns, see last example below. If alias is not used, the connector will postfix the column names with a counter value.</p>
<strong>Example</strong>: Some join example:
<p class="doccode">&gt; SELECT * FROM table1<br> INNER JOIN table2 ON table1.ID = table2.ID;<br><br>&gt; SELECT * FROM table1 AS A<br> INNER JOIN table2 AS B ON A.ID = B.ID<br> INNER JOIN table3 AS C ON B.ID = C.ID;<br><br>&gt; SELECT * FROM table1<br> LEFT JOIN table2 ON table1.ID = table2.ID<br> WHERE table2.ID IS NULL;<br><br>&gt; SELECT A.ID AS X, B.ID AS Y FROM table1 AS A<br> INNER JOIN table2 AS B ON A.ID = B.ID;</p>
</li>
</ol><ol class="doclistbullet">
<li>
<p>The <em>WHERE</em> clause, if provided, indicates conditions that each row must satisfy to be selected. The <em>where_condition</em> expression evaluates true or false for every row. The command selects all rows if there is no WHERE clause. The WHERE clause is evaluated after all join conditions have been applied. In the <em>where_condition</em> you can use any of the functions and operators that the connector supports except for aggregate functions. See <a href="#sql-statement-syntax-operators-and-functions">Operators And Functions</a> for detailed examples of WHERE usage and available operators.</p>
<p><strong>Example</strong>: to retrieve rows from list <em>Employees</em> where <em>Role</em> column is <em>Developer</em> or <em>Salesman</em>:</p>
<p class="doccode">SELECT * FROM Employees WHERE Role = 'Developer'" OR Role = 'Salesman'</p>
</li>
<li>The <em>GROUP BY </em>clause groups the results according to the group by expression and calculates aggregate functions in each group. The group by expression can be a column or a function. The group by is always evaluated after the WHERE clause but before the HAVING clause, thus only the HAVING clause can include aggregate functions. If the statement contains aggregate functions but no GROUP BY clause is specified, all rows are grouped into one single row.<br>
<p><strong>Example</strong>: to calculate salaries for each <em>Role</em> in <em>Employees</em>:</p>
<p class="doccode">SELECT Role, AVG(Salary), MAX(Salary), MIN(Salary) FROM Employees GROUP BY Role</p>
<p><strong>Example</strong>: to count number of developers in <em>Employees</em>:</p>
<p class="doccode">SELECT COUNT(ID) FROM Employees WHERE Role = 'Developer'</p>
</li>
<li>The <em>HAVING</em> clause is similar to the WHERE clause except that it is evaluated on the final results. Therefore the <em>where_condition</em> in this clause can also include aggregate functions. That is very useful in combination with GROUP BY to filter the final results based on aggregated values. See <a href="#sql-statement-syntax-operators-and-functions">Operators And Functions </a>for more examples.
<p><strong>Example</strong>: to calculate salaries for each <em>Role</em> in <em>Employees</em> having at least 5 employees in that role:</p>
<p class="doccode">SELECT Role, AVG(Salary), MAX(Salary), MIN(Salary) FROM Employees <br>GROUP BY Role HAVING Count(ID) &gt;= 5</p>
</li>
<li>
<p>The <em>ORDER BY</em> clause can be provided to sort the returned result-set by the specified column or columns. The default sort order is ascending, specified explicitly using the <em>ASC</em> keyword. To sort in reverse, add the <em>DESC</em> (descending) keyword to the column name in the <em>ORDER BY</em> clause. Multiple sort columns can be specified at which the sequence of the columns determines the mutual order of the rows.</p>
<p><strong>Example</strong>: to retrieve rows from list <em>Employees</em> ordered by the <em>Salary</em> column in descending order:</p>
<p class="doccode">SELECT * FROM Employees ORDER BY Salary DESC</p>
</li>
<li>
<p>The <em>LIMIT</em> clause is used to limit the number of rows returned by the <em>SELECT</em> statement. <em>LIMIT</em> is either followed by a single integer argument that indicates the maximum number of retrieved rows or a combination of two integer arguments where the first integer indicates the start index and the second integer the number of rows from offset. The latter can be used to produce paging behaviour in applications.  If <em>LIMIT</em> clause is not provided, the maximum number of rows returned is constrained by the list default value, which is typically 100 rows. The default value can be overriden through the <em>DefaultLimit</em> option in the connection string.</p>
<p><strong>Example</strong>: to retrieve rows from list <em>Employees</em> and limit the number rows to 1000:</p>
<p class="doccode">SELECT * FROM Employees LIMIT 1000</p>
<p><strong>Example</strong>: to retrieve rows from list <em>Employees</em> and limit the number rows to 100 starting at row 500:</p>
<p class="doccode">SELECT * FROM Employees LIMIT 500, 100</p>
</li>
</ol>
<p>The clauses used must be given in the exact order shown in the syntax description. The maximum length of identifiers (list names, column names and aliases) is 255 characters. Identifiers that contain special characters or reserved words, must be quoted by enclosing them within back-tick (`) characters. The following characters have special meanings in identifiers, thus requires quotation marks.</p>
<ol class="doclistbullet">
<li>White space</li>
<li>Period (.) is the delimiter character used to separate parts of a identifier name.</li>
<li>Back-tick (`) is the identifier quote character. This character must also be escaped within identifiers by doubling up on them as illustrated below.</li>
</ol>
<p><strong>Example</strong>: to select a column containing white space:</p>
<p class="doccode">SELECT `First Name` FROM Employees</p>
<p><strong>Example</strong>: to select a column enclosed within backticks:</p>
<p class="doccode">SELECT ```foo``` FROM bar</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print all customers</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SELECT Title, Country FROM Customers&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Country&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Sven Andersson                           : Sweden<br>John Smith                               : USA<br>Brett Wayne                              : United Kingdom<br>Nils Larsson                             : Sweden<br>Tim Sherwood                             : United Kingdom<br>Adam Sandler                             : USA<br>Mary Anderson                            : USA<br>Brian Aherne                             : United Kingdom<br>Steve Allen                              : USA<br>John Boles                               : USA<br>Anders Englund                           : Sweden</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print all customers from USA and  Sweden</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SELECT Title, Country FROM Customers WHERE Country IN (&#39;Sweden&#39;, &#39;USA&#39;)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Country&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Sven Andersson                           : Sweden<br>John Smith                               : USA<br>Nils Larsson                             : Sweden<br>Adam Sandler                             : USA<br>Mary Anderson                            : USA<br>Steve Allen                              : USA<br>John Boles                               : USA<br>Anders Englund                           : Sweden</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print all customers where name contains &quot;anders&quot; ordered</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(&quot;SELECT Title, Country FROM Customers WHERE Title LIKE &#39;%anders%&#39; ORDER BY Country, Title&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Country&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Anders Englund                           : Sweden<br>Sven Andersson                           : Sweden<br>Mary Anderson                            : USA</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print all customers where last name starts with &quot;s&quot;</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Title, Country FROM Customers WHERE Title REGEXP &#39;^(?i)([a-z]{1,}\s[s]{1,})&#39;&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Title&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Country&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">John Smith                               : USA<br>Tim Sherwood                             : United Kingdom<br>Adam Sandler                             : USA</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Print customer log joined</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers INNER JOIN Log ON Log.Customer = Customers.ID WHERE Customers.ID = 6 ORDER BY Log.Created ASC&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Adam Sandler                   : Logged in                      : 2012-04-19 22:05:31<br>Adam Sandler                   : Edited personal details        : 2012-04-19 22:06:31<br>Adam Sandler                   : Created new ticket             : 2012-04-19 22:07:30<br>Adam Sandler                   : Logged out                     : 2012-04-19 22:08:09</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-insert"><i>/3_5/sql-statement-syntax/insert</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>INSERT</h1>

            
  
  <p>INSERT is used to insert rows into a given list using any of the <strong>INSERT ... VALUES</strong> or <strong>INSERT ... SET</strong> forms to specify column-value pairs. The <strong>INSERT ... VALUES</strong> form allows multiple inserts in one statement at better performance than multiple single statements.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">INSERT INTO <br><em><strong> list_name</strong></em> [.{<em><strong>content_type_name</strong></em> | ATTACHMENTS}] <br> (<em><strong>col_name</strong></em> [, <em><strong>col_name</strong></em> ...]) <br> VALUES (<em><strong>expr</strong> </em>[, <em><strong>expr</strong> </em>...]) [, (...) ...];</p>
<p><strong>OR</strong></p>
<p class="doccode">INSERT INTO <br> <em><strong>list_name</strong></em> [.{<em><strong>content_type_name</strong> </em>| ATTACHMENTS}] <br> SET <em><strong>col_name</strong></em> = <em><strong>expr</strong> </em>[, col_name = expr ...];</p>
<p>The INSERT statement is used as follows:</p>
<ol class="doclistbullet">
<li>
<p>The <em>list_name</em> indicates the list into which the row should be inserted. Optionally, you can also specify the content type of the new row. If content type is not specified, the row is inserted with default content type.</p>
<p><strong>Example</strong>: to insert a new row of default content type into list <em>Colors</em>:</p>
<p class="doccode">INSERT INTO Colors (Title, HexCode) VALUES ('Red', '#FF0000')</p>
<p><strong>Example</strong>: to insert <span style="text-decoration: underline;">three</span> new rows of default content type into list <em>Colors</em>:</p>
<p class="doccode">INSERT INTO Colors (Title, HexCode) VALUES ('Red', '#FF0000'), ('Green', '#00FF00'), ('Blue', '#0000FF')</p>
<p><strong>Example</strong>: to insert a new row of content type <em>Greyish</em> into list <em>Colors</em>:</p>
<p class="doccode">INSERT INTO Colors.Greyish (Title, HexCode) VALUES ('Light', '#B0B0B0')</p>
</li>
<li>If you choose to specify a comma-separated list of column names following the list name, a value for each named column must be listed in the <em>VALUES</em> clause.</li>
<li>
<p>Use the SET clause to provide value for each column explicitly.</p>
<p><strong>Example</strong>: to insert a new row into list Colors using the SET form:</p>
<p class="doccode">INSERT INTO Colors SET Title = 'Red', HexCode = '#FF0000'</p>
</li>
<li>In <em>StrictMode</em>, SPC will generate an error if trying to insert value into a read-only column (for example the ID column of a list) or if value of a required column is missing.</li>
<li>In <em>StrictMode</em>, SPC will generate an error if trying to insert a string value that exceeds the column's maximum length.</li>
<li>
<p>In <em>StrictMode</em>, SPC will generate an error if trying to insert a numeric value that lies outside the column's range or precision.</p>
<p class="docnote"><strong>Note</strong>: When <em>StrictMode</em> is turned off, no range or precision validation is performed before data is sent to SP, possibly allowing values outside the boundaries. Therefore it is recommended to keep this option on.</p>
</li>
<li>
<p>Any column not explicitly given a value is set to its default value. Use the <em>DEFAULT</em> keyword to set a column explicitly to its default value. This makes it easier to build <em>INSERT</em> statements that sets some but not all columns.</p>
<p><strong>Example</strong>: using <em>DEFAULT</em> keyword to set a column explicitly to its default value:</p>
<p class="doccode">INSERT INTO Colors SET Title = 'Red', HexCode = '#FF0000', Enabled = DEFAULT</p>
</li>
<li>When the procedure returns, the application can obtain the ID of the last inserted item through the <strong>LastInsertedId</strong> property of the SharePointCommand class.</li>
</ol>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create new customer</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO Customers SET Title = &#39;King Carl XVI Gustaf&#39;, Country = &#39;Sweden&#39;&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 14</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create customer log</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO Log (Title, Customer) VALUES (&#39;Logged in&#39;, 12)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 5</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create customer log using parameters</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO Log (Title, Customer) VALUES (@p1, @p2)&quot;, connection))
    {
        command.Parameters.Add(&quot;@p1&quot;, &quot;Edited &#39;Phone number&#39;&quot;);
        command.Parameters.Add(&quot;@p2&quot;, 12);
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 6</p>
<p class="docnote"><strong>Note</strong>: It is recommended to use parameters because this protects against sql injection attacks and ensures that special characters can be inserted without escaping.</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-update"><i>/3_5/sql-statement-syntax/update</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>UPDATE</h1>

            
  
  <p>UPDATE is used to update columns of existing rows in a given list with new values.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">UPDATE <br> <strong>list_name</strong> [.<em><strong>content_type_name</strong></em>] <br> SET <em><strong>col_name</strong></em> = <em><strong>expr</strong> </em>[, col_name = expr ...] <br> [WHERE <em><strong>where_condition</strong></em>];</p>
<p>The UPDATE statement is used as follows:</p>
<ol class="doclistbullet">
<li>The <em>list_name</em> indicates the list to update rows in. Optionally, you can also specify the content type, in which case only rows of the given content type will be updated.</li>
<li>The <em>SET</em> clause indicates which columns to modify and the values they should be given. The usage is similar to that of the INSERT statement.</li>
<li>
<p>The <em>WHERE</em> clause, if given, specifies the conditions that are used to identify the rows to update. The <em>where_condition</em> evaluates true for all rows to be updated. With no WHERE clause all rows in the list are updated. See <a href="#sql-statement-syntax-operators-and-functions">Operators And Functions</a> for detailed examples of WHERE usage and available operators.</p>
<p><strong>Example</strong>: to update rows in the list <em>Employees</em> where <em>Role</em> column is not <em>Salesman</em>:</p>
<p class="doccode">UPDATE Employees SET Active = True WHERE Role &lt;&gt; 'Salesman';</p>
<p class="docnote">The DefaultLimit option in the connection string places a default limit on the number of rows that can be updated.</p>
</li>
<li>When the procedure returns, the application can obtain the number of rows affected through the <strong>LastRecordsAffected</strong> property of the SharePointCommand class.</li>
</ol>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Update customers without country</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;Update Customers SET Country = &#39;Unknown&#39; WHERE Country IS NULL&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Affected rows = &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Affected rows = 1</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Set all customers as active</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;Update Customers SET Active = True&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Affected rows = &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Affected rows = 13</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-delete"><i>/3_5/sql-statement-syntax/delete</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DELETE</h1>

            
  
  <p>DELETE is used to delete existing rows from a list.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">DELETE <br> FROM <em><strong>list_name</strong></em> [.{<em><strong>content_type_name</strong></em> | ATTACHMENTS}] <br> [WHERE <em><strong>where_condition</strong></em>];</p>
<p>The DELETE statement is used as follows:</p>
<ol class="doclistbullet">
<li>The <em>list_name</em> indicates the list to delete rows from. Optionally, you can also specify the content type, in which case only rows of the given content type will be deleted.</li>
<li>
<p>The <em>WHERE</em> clause, if given, specifies the conditions that are used to identify the rows to delete. The <em>where_condition</em> evaluates true for all rows to be deleted. With no WHERE clause all rows in the list are deleted. See <a href="#sql-statement-syntax-operators-and-functions">Operators And Functions</a> for detailed examples of WHERE usage and available operators.</p>
<p><strong>Example</strong>: to delete rows from the list <em>Employees</em> where <em>Active</em> column is <em>False</em>:</p>
<p class="doccode">DELETE FROM Employees WHERE Active = False;</p>
<p class="docnote">The DefaultLimit option in the connection string places a default limit on the number of rows that can be deleted.</p>
</li>
<li>When the procedure returns, the application can obtain the number of rows affected through the <strong>LastRecordsAffected</strong> property of the SharePointCommand class.</li>
</ol>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete all inactive customers</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;DELETE FROM Customers WHERE Active = False&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Affected rows = &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Affected rows = 2</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-join"><i>/3_5/sql-statement-syntax/join</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>JOIN</h1>

            
  
  <p>The JOIN clause is used in <a href="#sql-statement-syntax-select">SELECT</a> statements to join results from multiple lists based on join conditions.</p>
<p>The JOIN compares each row of the left side list with each row of the right side list to find all pairs of rows which satisfy the join condition. When the join condition is satisfied, column values from the left side list and the right side list are combined into a single result row.</p>
<p>The connector supports two types of joins; INNER JOIN and LEFT JOIN. For INNER JOIN, each and every row in the first list is joined to each and every row in the second list where the join condition is satisfied.  If the join condition evaluates false, the row is not selected. For LEFT JOIN, if the join condition evaluates false, all selected columns from the left side list are returned but with NULL in all selected columns from the right side list. You can use LEFT JOIN to find rows in a list that have no counterpart in another list. The OUTER is an optional keyword in LEFT JOIN but does not change its behaviour.</p>
<p>The <em class="replaceable">join_condition</em> used with ON is any conditional expression of the form that can be used in a WHERE clause. Generally, you should use the ON clause for conditions that specify how to join tables and the WHERE clause to restrict which rows you want in the final results.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SELECT ...<br> [INNER JOIN | LEFT [OUTER] JOIN] <em><strong>list_name</strong></em> ON <em><strong>join_condition</strong></em><br> [[INNER JOIN | LEFT [OUTER] JOIN] <em><strong>list_name</strong></em> ON <em><strong>join_condition</strong></em>]</p>
<p>The JOIN clause is used as follows:</p>
<ol class="doclistbullet">
<li>
<p>The JOIN requires using the ON clause and specifying a <em>join_condition</em>. However, you can still produce a Cartesian product between the specified tables, that is, each and every row in the first table is joined to each and every row in the second table, by specifying a condition that always evaluates true.</p>
</li>
<li>
<p>The <em>join_condition</em> is any conditonal expression that can be used in a WHERE clause. The join condition may use any columns from the left side list and the right side list.</p>
</li>
<li>
<p>You can specify multiple JOIN clauses in the query. Each JOIN will join the right side list with all lists added on the left side of the JOIN clause.</p>
</li>
<li>
<p>You can select any columns from all the lists that you join, but each one must be named uniquely. If two lists contained equaly named columns, it is recommended that you use column alias to name these columns. If two columns have the same name, the connector will add a postfix counter value to these columns.</p>
</li>
<li>Uniquely named columns can be referenced with column name only, e.g. <em>User</em>. Ambigious columns must be referenced with list prefix, e.g. <em>Log.User</em>.</li>
<li>
<p>You can use asterisk symbol (*) to select all columns from all lists that you join.</p>
</li>
<li>
<p>The WHERE and ORDER BY clause can use any columns from all the lists that you join.</p>
<p><strong>Example</strong>: simplest join between two tables:</p>
<p class="doccode">SELECT table1.a, table2.b FROM table1 <br>INNER JOIN table2 ON table1.a = table2.b</p>
<p><strong>Example</strong>: join between two tables with alias:</p>
<p class="doccode">SELECT table1.a AS x, table2.a AS y FROM table1 <br>INNER JOIN table2 ON x = y</p>
<p><strong>Example</strong>: join between two tables with WHERE and ORDER BY:</p>
<p class="doccode">SELECT table1.a AS x, table2.a AS y FROM table1 <br>INNER JOIN table2 ON x = y<br>WHERE table1.b = 'foo' AND table2.b = 'bar'<br>ORDER BY x, y</p>
<p><strong>Example</strong>: use the WHERE clause in combination with LEFT JOIN to select non-matching rows:</p>
<p class="doccode">SELECT table1.a AS x, table2.a AS y FROM table1 <br>LEFT JOIN table2 ON x = y<br>WHERE y IS NULL</p>
</li>
</ol>
<h3>Code examples</h3>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Inner join customers with log</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers INNER JOIN Log ON Customers.ID = Log.Customer&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Adam Sandler                   : Logged in                      : 2012-04-19 22:05:31<br>Adam Sandler                   : Edited personal details        : 2012-04-19 22:06:31<br>Adam Sandler                   : Created new ticket             : 2012-04-19 22:07:30<br>Adam Sandler                   : Logged out                     : 2012-04-19 22:08:09<br>King Carl XVI Gustaf           : Logged in                      : 2012-04-19 22:32:22<br>King Carl XVI Gustaf           : Edited 'Phone number'          : 2012-04-19 22:36:44</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Left join customers with log</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers LEFT JOIN Log ON Customers.ID = Log.Customer&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Sven Andersson                 :                                :<br>John Smith                     :                                :<br>Brett Wayne                    :                                :<br>Nils Larsson                   :                                :<br>Tim Sherwood                   :                                :<br>Adam Sandler                   : Logged in                      : 2012-04-19 22:05:31<br>Adam Sandler                   : Edited personal details        : 2012-04-19 22:06:31<br>Adam Sandler                   : Created new ticket             : 2012-04-19 22:07:30<br>Adam Sandler                   : Logged out                     : 2012-04-19 22:08:09<br>Mary Anderson                  :                                :<br>Brian Aherne                   :                                :<br>Steve Allen                    :                                :<br>John Boles                     :                                :<br>Anders Englund                 :                                :<br>King Carl XVI Gustaf           : Logged in                      : 2012-04-19 22:32:22<br>King Carl XVI Gustaf           : Edited 'Phone number'          : 2012-04-19 22:36:44<br>Jerry Buss                     :                                :</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Left join customers with log where no log exists</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers LEFT JOIN Log ON Customers.ID = Log.Customer WHERE Log.ID IS NULL&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Sven Andersson                 :                                :<br>John Smith                     :                                :<br>Brett Wayne                    :                                :<br>Nils Larsson                   :                                :<br>Tim Sherwood                   :                                :<br>Mary Anderson                  :                                :<br>Brian Aherne                   :                                :<br>Steve Allen                    :                                :<br>John Boles                     :                                :<br>Anders Englund                 :                                :<br>Jerry Buss                     :                                :</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Left join customers with log where customer last name starts with &quot;s&quot;</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT Customers.Title AS Name, Log.Title AS Event, Log.Created FROM Customers LEFT JOIN Log ON Customers.ID = Log.Customer WHERE Name REGEXP &#39;^(?i)[a-z]{1,}\ss&#39;&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Event&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Created&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">John Smith                     :                                :<br>Tim Sherwood                   :                                :<br>Adam Sandler                   : Logged in                      : 2012-04-19 22:05:31<br>Adam Sandler                   : Edited personal details        : 2012-04-19 22:06:31<br>Adam Sandler                   : Created new ticket             : 2012-04-19 22:07:30<br>Adam Sandler                   : Logged out                     : 2012-04-19 22:08:09</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-group-by"><i>/3_5/sql-statement-syntax/group-by</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>GROUP BY</h1>

            
  
  <p>The GROUP BY clause is used in <a href="#sql-statement-syntax-select">SELECT</a> statements to group selected rows by the value of a column or other expression into a set of summary rows and calculate any <a href="#operators-and-functions-aggregate-functions">aggregate functions</a> in each group. The GROUP BY clause is always evaluated after the WHERE clause but before the HAVING clause. Therefore, the WHERE clause cannot contain aggregate functions.</p>
<p>The <a href="#operators-and-functions-aggregate-functions">aggregate functions</a> allow you to perform calculations on each group into single values. The most common aggregate functions are SUM, AVG, MAX, MIN and COUNT. The HAVING clause can then be used to filter the final results similar to the WHERE clause but including aggregated values. When no GROUP BY clause is specified but statement includes aggregate functions, all selected rows are grouped into one single row.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SELECT ...<br>GROUP BY {<em><strong>col_name</strong></em> | <em><strong>expression</strong></em>}</p>
<p>The GROUP BY clause is used as follows:</p>
<ol class="doclistbullet">
<li>
<p>The GROUP BY clause consists of the GROUP BY keyword followed by a single expression. The expression can be a column reference or any function supported by the connector except for aggregate functions (which are calculated as result of the GROUP BY).</p>
<p><strong>Example</strong>: simple select that returns the number of employees for each role:</p>
<p class="doccode">SELECT Role, COUNT(ID) FROM Employees GROUP BY Role</p>
<p><strong>Example</strong>: using functions as GROUP BY expressions, here grouping by the year when employee was created:</p>
<p class="doccode">SELECT DATEFORMAT(Created, 'yyyy') as Year, COUNT(ID) FROM Employees <br>GROUP BY DATEFORMAT(Created, 'yyyy')</p>
</li>
<li>
<p>The aggregate functions, such as AVG or COUNT, can be used in the SELECT, HAVING or ORDER BY clause.</p>
<p><strong>Example</strong>: selecting the average age of employees for each role where average is at least 30 and finally sorting on age in ascending order.</p>
<p class="doccode">SELECT Role, AVG(Age) AS Average FROM Employees <br>GROUP BY Role <br>HAVING Average &gt;= 30<br>ORDER BY Average ASC</p>
</li>
<li>
<p>For selected columns that are not part of the group by expression or aggregate functions the final results contains the value of the first row in each group. Because the ORDER BY clause is evaluated after the GROUP BY clause, there is no given sort order within each group of rows. Be careful when selecting columns, since the value of such columns can not be predicted.</p>
<p><strong>Example</strong>: the following value of Sex cannot be predicted because it can be any of M/F:</p>
<p class="doccode">SELECT Role, Sex, COUNT(ID) FROM Employees GROUP BY Role</p>
</li>
</ol>
<h3>Code examples</h3>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Calculate sum of orders per customer</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT C.Name, COUNT(O.ID) AS Count, SUM(O.Price) AS Sum FROM Customers C INNER JOIN Orders O ON C.ID = O.Customer GROUP BY C.ID ORDER BY C.Name&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Name&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Count&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Sum&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Adam Sandler                   : 1                             : 500<br>John Smith                     : 12                            : 6000<br>King Carl XVI Gustaf           : 3                             : 1500<br>Leia Hunden                    : 4                             : 2000<br>Ulf Engstrand                  : 6                             : 3000</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Calculate sum of orders per country</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT C.Country, SUM(O.Price) AS Sum FROM Customers C INNER JOIN Orders O ON C.ID = O.Customer GROUP BY C.Country ORDER BY Sum&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Country&quot;].ToString().PadRight(30) + &quot; : &quot; + &quot; : &quot; + reader[&quot;Sum&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Sweden                         : 6500<br>United Kingdom                 : 6000<br>USA                            : 500</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Calculate sum of orders per month in year 2012</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT MONTH(Created) AS Month, SUM(Price) AS Sum FROM Orders WHERE YEAR(Created) = 2012 GROUP BY MONTH(Created) ORDER BY MONTH(Created)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;Month&quot;].ToString().PadRight(30) + &quot; : &quot; + &quot; : &quot; + reader[&quot;Sum&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">1                              : 500<br>3                              : 1000<br>4                              : 2500<br>5                              : 1500<br>8                              : 1500<br>10                             : 1000<br>11                             : 3000<br>12                             : 2000</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-union"><i>/3_5/sql-statement-syntax/union</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>UNION</h1>

            
  
  <p>UNION is used to combine the result from multiple <a href="#sql-statement-syntax-select">SELECT</a> statements into a single result set.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SELECT ...<br> UNION [DISTINCT] SELECT ...<br> [UNION [DISTINCT] SELECT ...]</p>
<p>The UNION statement is used as follows:</p>
<ol class="doclistbullet">
<li>Each SELECT statement must provide the same number of columns. Selected columns listed in corresponding positions of each SELECT statement should have the same data type. For example, the first column selected by the first statement should have the same type as the first column selected by the other statements.</li>
</ol><ol class="doclistbullet">
<li>
<p>The column names from the first SELECT statement are used as the column names for the results returned.</p>
</li>
<li>
<p>Only the last SELECT can contain ORDER BY and LIMIT. ORDER BY and LIMIT will be applied on the entire results. The ORDER BY clause must use the column names for the first SELECT. </p>
</li>
<li>
<p>The default behavior for UNION is that all rows from all SELECT statements are returned. With the optional DISTINCT keyword duplicate rows are removed from the results. Mxed UNION types are treated such that a DISTINCT union overrides any ALL union to its left.</p>
<p><strong>Example</strong>: to retrieve data from Employees where ID is less than 10 and union where ID is greater than 20:</p>
<p class="doccode">SELECT ID, Title FROM Employees WHERE ID &lt; 10 <br>UNION <br>SELECT ID, Title FROM Employees WHERE ID &gt; 20</p>
<p><strong>Example</strong>: to retrieve distinct results from two lists:</p>
<p class="doccode">SELECT ID, Title FROM Employees<br>UNION DISTINCT<br>SELECT ID, Title FROM EmployeesBackup</p>
</li>
</ol>
<h3>Code examples</h3>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Select all customers including backups</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT ID, Title FROM Customers UNION SELECT ID, Title FROM CustomersBackup ORDER BY ID ASC&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;ID&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Title&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">1                              : Sven Andersson<br>1                              : Sven Andersson<br>2                              : John Smith<br>2                              : John Smith<br>3                              : Brett Wayne<br>3                              : Brett Wayne<br>4                              : Nils Larsson<br>4                              : Nils Larsson<br>5                              : Tim Sherwood<br>5                              : Tim Sherwood<br>6                              : Adam Sandler<br>6                              : Adam Sandler<br>7                              : Mary Anderson<br>7                              : Mary Anderson<br>8                              : Brian Aherne<br>8                              : Brian Aherne<br>9                              : Steve Allen<br>9                              : Steve Allen<br>10                             : John Boles<br>10                             : John Boles<br>11                             : Anders Englund<br>11                             : Anders Englund<br>12                             : King Carl XVI Gustaf<br>12                             : King Carl XVI Gustaf<br>15                             : Jerry Buss<br>15                             : Jerry Buss</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Select all distinct customers including backups</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;SELECT ID, Title FROM Customers UNION DISTINCT SELECT ID, Title FROM CustomersBackup ORDER BY ID ASC&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;ID&quot;].ToString().PadRight(30) + &quot; : &quot; + reader[&quot;Title&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">1                              : Sven Andersson<br>2                              : John Smith<br>3                              : Brett Wayne<br>4                              : Nils Larsson<br>5                              : Tim Sherwood<br>6                              : Adam Sandler<br>7                              : Mary Anderson<br>8                              : Brian Aherne<br>9                              : Steve Allen<br>10                             : John Boles<br>11                             : Anders Englund<br>12                             : King Carl XVI Gustaf<br>15                             : Jerry Buss</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-call"><i>/3_5/sql-statement-syntax/call</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CALL</h1>

            
  
  <p>CALL is used to invoke a predefined procedure. For the complete listing of availble procedures see <a href="#3_5-procedures">Procedures</a>.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">CALL <em><strong>procedure_name</strong></em>([<em><strong>parameter</strong></em>[,...]]);</p>
<p>The CALL statement is used as follows:</p>
<ol class="doclistbullet">
<li>The <em>procedure_name</em> indicates the procedure to invoke. The procedure name must followed by parentheses surrounding all its parameters.</li>
<li>
<p>The procedure may take one or more IN parameters.</p>
<p><strong>Example</strong>: to create a simple text file named <em>test.txt</em> in the document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL UPLOAD('Shared Documents', 'test.txt', 'This is a small text file..');</p>
</li>
<li>
<p>Like with other statements, procedures can produce result sets.</p>
<p><strong>Example</strong>: to download the file named <em>test.txt</em> from the document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DOWNLOAD('Shared Documents', 'test.txt');</p>
<p>In this case, the procedure will produce a scalar binary value.</p>
</li>
<li>
<p>When the procedure returns, the application can obtain the number of rows affected through the <strong>LastRecordsAffected</strong> property and the ID of the last inserted item through the <strong>LastInsertedId</strong> property of the SharePointCommand class if the procedure supports this. The UPLOAD() procedure, to mention one, cannot suppport this because the command does not query the actual list directly.</p>
</li>
</ol>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create folder</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL CreateFolder(&#39;Shared Documents&#39;, &#39;Images&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 4</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Upload document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL UPLOAD(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;, @doc)&quot;, connection))
    {
        command.Parameters.Add(&quot;@doc&quot;, System.IO.File.ReadAllBytes(@&quot;C:\bendsoft.jpg&quot;));
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Download document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DOWNLOAD(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        byte[] data = (byte[])command.ExecuteScalar();
        Console.WriteLine(&quot;Date length = &quot; + data.Length);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Date length = 20140</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Copy document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL COPY(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;, &#39;Shared Documents&#39;, &#39;Images/bendsoft_backup.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DELETE(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Rename document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL RENAME(&#39;Shared Documents&#39;, &#39;Images/bendsoft_backup.jpg&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-use"><i>/3_5/sql-statement-syntax/use</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>USE</h1>

            
  
  <p>USE tells the Connector to switch SharePoint site for subsequent statements. The specified site remains selected until the SharePointConnection is reused or another USE statement is issued.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">USE <em><strong>list_name</strong></em>;</p>
<p>The USE statement is provided as a quick way to change site without having to change the connection string and open a new SharePointConnection.</p>
<p><strong>Example</strong>: to change to the site <em>Marketing/Material</em>:</p>
<p class="doccode">USE `Marketing/Material`;</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Change site and list shared documents</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;USE `sites/demo`&quot;, connection))
    {
        command.ExecuteNonQuery();
    }

    using (var command = new SharePointCommand(&quot;SELECT ServerUrl, Modified FROM `Shared Documents`&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader[&quot;ServerUrl&quot;].ToString().PadRight(40) + &quot; : &quot; + reader[&quot;Modified&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Images                                   : 2012-04-19 23:29:37<br>Images/bendsoft.jpg                      : 2012-04-19 23:49:46</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-last_insert_id()"><i>/3_5/sql-statement-syntax/last_insert_id()</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>LAST_INSERT_ID()</h1>

            
  
  <p>The LAST_INSERT_ID() function in a SELECT statement returns the last automatically generated item ID that was set by the most recent successful INSERT or CALL statement to a list or document library. The value only remains within the same SharePointConnection instance. The return type is Int32.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SELECT LAST_INSERT_ID();</p>
<p>The LAST_INSERT_ID() function produces the same value as the <a href="#executing-commands-last-inserted-id"><strong>LastInsertedId</strong></a> property of the SharePointCommand class.</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Using the LAST_INSERT_ID() function</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;INSERT INTO employees (name) VALUES (&#39;Steve Watson&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
    using (var command = new SharePointCommand(@&quot;SELECT LAST_INSERT_ID()&quot;, connection))
    {
        var lastInsertedId = (int)command.ExecuteScalar();
        Console.WriteLine(&quot;Steve&#39;s ID is:&quot; + lastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Steve's ID is:23</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="sql-statement-syntax-operators-and-functions"><i>/3_5/sql-statement-syntax/operators-and-functions</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Operators and functions</h1>

            
  
  <p>This section describes functions and operators that are permitted when writing expressions in the connector. Expressions can be used at many points in SQL statements, such as in the ORDER BY, <a href="#sql-statement-syntax-group-by" title="GROUP BY">GROUP BY</a> or HAVING clauses of the <a href="#sql-statement-syntax-select">SELECT</a> statement or in the WHERE clause of the <a href="#sql-statement-syntax-select">SELECT</a>, <a href="#sql-statement-syntax-delete">DELETE</a>, and <a href="#sql-statement-syntax-update">UPDATE</a> statement. Expressions can be composed by literal values, column values, functions and operators. In general, there are two types of functions - scalar and aggregate. Scalar functions operate on a single value or list of values, as opposed to aggregate functions, which operate on the data from multiple rows.</p>
<p>See the following categories for further knowledge:</p>
<ul>
<li><a href="#operators-and-functions-string-functions" title="String functions">String functions</a></li>
<li><a href="#operators-and-functions-date-functions">Date functions</a></li>
<li><a href="#operators-and-functions-numeric-functions">Numeric functions</a></li>
<li><a href="#operators-and-functions-aggregate-functions">Aggregate functions</a></li>
</ul>
<hr>
<h3>Logical operators and functions</h3>
<p>The table below shows logical operators and comparison functions that can be used in the HAVING clause of the <a href="#sql-statement-syntax-select">SELECT</a> statement or in the WHERE clause of the <a href="#sql-statement-syntax-select">SELECT</a>, <a href="#sql-statement-syntax-update">UPDATE</a> and <a href="#sql-statement-syntax-delete">DELETE</a> statement.</p>
<p>The WHERE or HAVING clause is composed by a combination of logical operators and expressions that evaluates either TRUE or FALSE for a row of values. Some functions, such as <a href="#least">LEAST()</a> and <a href="#greatest">GREATEST()</a>, return values rather than TRUE or FALSE. However, the return value is still based on comparison operations. The connector performs type conversion as necessary, e.g. string to number or string to date. To convert a value to a specific type for comparison purposes, you can use the <a href="#cast">CAST()</a> function.</p>
<p>By default, string comparisons are not case sensitive and use invariant culture. The exception is the <a href="#regexp">REGEXP</a> operator which is by default case sensitive. This behaviour can however be specified in the regular expression itself.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Description</th><th>Availabilty</th></tr>
<tr>
<td><a href="#and">AND</a></td>
<td>Logical AND</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#or">OR</a></td>
<td>Logical OR</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#not">NOT</a></td>
<td>Negates comparison</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#equal">=</a></td>
<td>Equal operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#notequal">&lt;&gt;,!=</a></td>
<td>Not equal operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#less">&lt;</a></td>
<td>Less than operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#lessorequal">&lt;=</a></td>
<td>Less than or equal operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#greater">&gt;</a></td>
<td>Greater than operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#greaterorequal">&gt;=</a></td>
<td>Greater than or equal operator</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#isnull">IS NULL</a></td>
<td>Null test value</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#isnotnull">IS NOT NULL</a></td>
<td>Not null test value</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#in">IN()</a></td>
<td>Test if a value is found in a set of values</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#contains">CONTAINS()</a></td>
<td>Test if an array of values contains any value in a set if values</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#like">LIKE</a></td>
<td>Pattern matching</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#regexp">REGEXP</a></td>
<td>Test value against a regular expression</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#isnull_f">ISNULL()</a></td>
<td>Return <strong>TRUE</strong> if argument is null</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#greatest">GREATEST()</a></td>
<td>Return the greatest value of all arguments</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#least">LEAST()</a></td>
<td>Return the least value of all arguments</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#coalesce">COALESCE()</a></td>
<td>Return the first value that is not NULL of all arguments</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#userid">USERID()</a></td>
<td>Used to compare columns of type <em>User</em> or <em>UserMulti</em>. This server function evaluates to the ID of the authenticated user.</td>
<td>WHERE/HAVING</td>
</tr>
<tr>
<td><a href="#showfield">SHOWFIELD()</a></td>
<td>Used on <em>Lookup</em> and <em>User</em> columns to SELECT the display name of referenced list items.</td>
<td>ALL</td>
</tr>
<tr>
<td><a href="#lookup">LOOKUP()</a></td>
<td>Used on <em>Lookup</em> and <em>User</em> columns to select both ID and the display name of referenced list items.</td>
<td><span>ALL</span></td>
</tr>
<tr>
<td><a href="#cast">CAST()</a></td>
<td>Cast value to specified data type</td>
<td>ALL</td>
</tr>
</tbody>
</table>
<h3>Logical operators</h3>
<ul>
<li><a name="and"></a>AND <em>expression</em><br>
<p>Matches multiple comparisons using logical AND, i.e. all comparisons must evaluate TRUE for complete statement to evaluate TRUE.</p>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID = 4 AND Name = 'Steve Watson' AND Created = '2010-05-20'</p>
</li>
</ul>
<ul>
<li><a name="or"></a>OR <em>expression</em><br>
<p>Matches multiple comparisons using logical OR, i.e. at least one comparison must evaluate TRUE for complete statement to evaluate TRUE.</p>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID = 4 OR Name = 'Steve Watson' OR Created = '2010-05-20'</p>
</li>
</ul>
<ul>
<li><a name="not"></a>NOT <em>expression</em><br>
<p>Negaties one or more comparisons. Can be used in combinations of other comparison operators and logical operators.</p>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE <strong>NOT </strong>ID = 4:<br>&gt; SELECT * FROM `Customers` WHERE <strong>NOT </strong>Name IN ('Steve Watsson', 'John Stevesson', 'Wat Johnsson');<br>&gt; SELECT * FROM `Customers` WHERE ID = 4 AND Name = 'Steve Watson' AND <strong>NOT </strong>Created = '2010-05-20'</p>
</li>
</ul>
<h3>Comparison operators</h3>
<ul>
<li><em><a name="equal"></a>value1</em> equal <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID = 4;<br>&gt; SELECT * FROM `Customers` WHERE Name = 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created = '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID = 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><a name="notequal"></a><em>value1</em> not equal <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID &lt;&gt; 4;<br>&gt; SELECT * FROM `Customers` WHERE Name &lt;&gt; 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created &lt;&gt; '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID &lt;&gt; 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><a name="less"></a>v<em>alue1</em> less than <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID &lt; 4;<br>&gt; SELECT * FROM `Customers` WHERE Name &lt; 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created &lt; '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID &lt; 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><em><a name="lessorequal"></a>value1</em> less than or equal <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID &lt;= 4;<br>&gt; SELECT * FROM `Customers` WHERE Name &lt;= 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created &lt;= '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID &lt;= 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><em><a name="greater"></a>value1 g</em>reater than <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID &gt; 4;<br>&gt; SELECT * FROM `Customers` WHERE Name &gt; 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created &gt; '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID &gt; 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><em><a name="greaterorequal"></a>value1</em> greater than or equal <em>value2</em><br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID &gt;= 4;<br>&gt; SELECT * FROM `Customers` WHERE Name &gt;= 'Steve Watson';<br>&gt; SELECT * FROM `Customers` WHERE Created &gt;= '2010-05-20';<br>&gt; SELECT * FROM `Customers` WHERE GUID &gt;= 'e7538ba0-8835-4d7f-9af3-69b04011ea7a';</p>
</li>
</ul>
<ul>
<li><a name="isnull"></a><em>value</em> IS NULL<br><br>Tests whether a value is NULL.<br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Name IS NULL;</p>
</li>
</ul>
<ul>
<li><em><a name="isnotnull"></a>value</em> IS NOT NULL<br><br>Tests whether a value is not NULL.<br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Name IS NOT NULL;</p>
</li>
</ul>
<ul>
<li><a name="in"></a><em>value</em> IN (<em>value1</em>, <em>value2</em>, ...)<br><br>Tests whether a value is found in a set of values.<br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ID IN (1,2,3,4);<br>&gt; SELECT * FROM `Customers` WHERE Name IN ('Steve Watsson', 'John Stevesson', 'Wat Johnsson');</p>
</li>
</ul>
<ul>
<li><a name="contains"></a><em>array</em> CONTAINS (<em>value1</em>, <em>value2</em>, ...)<br><br>Tests whether an array of values contains any value in a set of values. This type is applicable on <em>MultiChoice</em> and <em>LookupMulti</em> columns.<em><em><br></em></em>
<p class="doccode">&gt; SELECT * FROM `Foo` WHERE MultiChoiceColumn CONTAINS ('bar');<br>&gt; SELECT * FROM `Foo` WHERE LookupMultiColumn CONTAINS (44, 43);</p>
</li>
</ul>
<ul>
<li><a name="like"></a><em>value</em> LIKE <em>string</em><br><br>Simple pattern matching (starts with, contains, ends with). The '%' character marks the beginning or end of a word and represents any number of any characters.<em><em><br></em></em>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Name LIKE '%sson'<br>&gt; SELECT * FROM `Customers` WHERE Name LIKE 'Steve%'<br>&gt; SELECT * FROM `Customers` WHERE Name LIKE '%John%'</p>
</li>
</ul>
<ul>
<li><em><a name="regexp"></a>value</em> REGEXP<em> string</em><br><br>Tests whether a value matches a regular expression. By default, this operator is case sensitive. To turn of case sensitivity, apply the (?i) to your match pattern.<em><em><br></em></em>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Name REGEXP '^(Steve|John|Wat) (Steve|Wat|John)sson$';</p>
<p><em>Matches Steve Watsson, John Stevesson, Wat Johnsson, but not 'steve watsson'<br></em></p>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Name REGEXP '^(?i)((Steve|John|Wat) (Steve|Wat|John)sson)$';</p>
<p><em>Matches Steve Watsson, John Stevesson, Wat Johnsson, and also 'steve watsson'</em></p>
<p class="doccode">&gt; <span>SELECT * FROM `Tasks` WHERE Status REGEXP '^(?!Completed)(?!Deferred)';</span></p>
<p><em>Selects all items from a standard tasklist that are <strong>not</strong> Completed to Deferred</em></p>
</li>
</ul>
<h3>Comparison functions</h3>
<ul>
<li><em><a name="isnull_f"></a>value</em> ISNULL()<br><br>Evaluates true if value is NULL.<br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE ISNULL(Name);</p>
<em>Select all items where Name is null</em><br>
<p class="doccode">&gt; SELECT ISNULL(Name) FROM `Customers`;</p>
<em>Return True for all items where Name is null</em></li>
</ul>
<ul>
<li><a name="greatest"></a>GREATEST(<em>value1</em>, <em>value2</em>, ..)<br><br>Returns the greatest value of all arguments<strong><strong><br></strong></strong>
<p class="doccode">&gt; SELECT GREATEST(sev1, sev2, sev3) FROM `Severity`;</p>
</li>
</ul>
<ul>
<li><a name="least"></a>LEAST(<em>value1</em>, <em>value2</em>, ..)<br><br>Returns the least value of all arguments<strong><strong><br></strong></strong>
<p class="doccode">&gt; SELECT LEAST(sev1, sev2, sev3) FROM `Severity`;</p>
</li>
</ul>
<ul>
<li><a name="coalesce"></a>COALESCE(<em>value1</em>, <em>value2</em>, ..)<br><br>Returns the first value in set that is not null<br>
<p class="doccode">&gt; SELECT COALESCE(Account, -1) FROM `Customers`;</p>
<em>Returns -1 if Account is null</em></li>
</ul>
<ul>
<li><a name="userid"></a>USERID()<br><br>Evaluates to the current authenticated user, i.e. the user authenticated with the connection string. This function is applicable on <em>User </em>and <em>MultiUser </em>columns. The following example selects all rows from the customers list that was created by the user.<br>
<p class="doccode">&gt; SELECT * FROM `Customers` WHERE Author = USERID();</p>
</li>
</ul>
<ul>
<li><a name="showfield"></a>SHOWFIELD(<em>column</em>)<br><br>Use on <a href="#data-types-lookup-lookupmulti">Lookup</a> and <a href="#data-types-user-usermulti">User</a> columns to select the display name of referenced lookup items instead of the ID.<br>
<p class="doccode">&gt; SELECT <span>SHOWFIELD(User)</span> FROM `Employees`;</p>
<p class="doccode">&gt; SELECT * FROM `Employees` WHERE <span>SHOWFIELD(User)</span> = 'Bend Softson';</p>
</li>
</ul>
<ul>
<li><span><a name="lookup"></a>LOOKUP</span>(<em>column</em>)<br><br>Use on <a href="#data-types-lookup-lookupmulti">Lookup</a> and <a href="#data-types-user-usermulti">User</a> columns to select both ID and the display name of referenced lookup items instead of only the ID.<br>
<p class="doccode">&gt; SELECT <span>LOOKUP</span>(User) FROM `Employees`;</p>
</li>
<li><span><a name="cast"></a>CAST</span>(<em>value</em>, <em>string type</em>)<br><br>Cast value to specified type. The possible types are: <a href="#data-types-datetime">DATETIME</a>, <a href="#data-types-boolean">BOOLEAN</a>, <a href="#data-types-number-currency">DOUBLE</a>, <a href="#data-types-number-currency">NUMBER</a>, <a href="#data-types-integer">INTEGER</a>, <a href="#data-types-text">STRING</a>, <a href="#data-types-text">TEXT</a>.<br>
<p class="doccode">&gt; SELECT CAST(Title, 'INTEGER') FROM `Orders`;</p>
</li>
</ul>
  
  

        </div><hr/></div><a name="operators-and-functions-string-functions"><i style="color:red;">Section unavailable: /3_5/sql-statement-syntax/operators-and-functions/string-functions</i></a><hr/><a name="operators-and-functions-date-functions"><i style="color:red;">Section unavailable: /3_5/sql-statement-syntax/operators-and-functions/date-functions</i></a><hr/><a name="operators-and-functions-numeric-functions"><i style="color:red;">Section unavailable: /3_5/sql-statement-syntax/operators-and-functions/numeric-functions</i></a><hr/><a name="operators-and-functions-aggregate-functions"><i style="color:red;">Section unavailable: /3_5/sql-statement-syntax/operators-and-functions/aggregate-functions</i></a><hr/><div id="section"><a name="3_5-procedures"><i>/3_5/procedures</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Procedures</h1>

            
  
  <p>This chapter describes procedures supported by the Camelot .NET Connector with code examples. Procedures are built-in methods that perform complex tasks that are not easily expressed with standard SELECT, INSERT, UPDATE or DELETE syntax, such as creating a folder in a document library or uploading documents. The connector provides a wide range of procedures for working with document libraries.</p>
  
  

        </div><hr/></div><div id="section"><a name="procedures-createfolder"><i>/3_5/procedures/createfolder</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CREATEFOLDER</h1>

            
  
  <p>Used to create a folder in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">CREATEFOLDER(string listName, string folder, [boolean recursive = false]);</p>
<p><strong>Example</strong>: to create folder <em>Images</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEFOLDER('Shared Documents', 'Images');</p>
<p>It is also possible to create subfolders of existing folders.</p>
<p><strong>Example</strong>: to create subfolder <em>Logos</em> under folder <em>Images</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEFOLDER('Shared Documents', 'Images/Logos');</p>
<p>By default all parent folders must exist when creating subfolders. Use the <strong>recursive</strong> parameter to create all subfolders recursively.</p>
<p><strong>Example</strong>: to create subfolder <em>a/b/c/d</em> recursively in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEFOLDER('Shared Documents', 'a/b/c/d', true);</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create folder</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL CREATEFOLDER(&#39;Shared Documents&#39;, &#39;Images&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 4</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-createdocumentset"><i>/3_5/procedures/createdocumentset</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CREATEDOCUMENTSET</h1>

            
  
  <p>Used to create a folder as a <strong>document set</strong> in a document library. A document set is a group of related documents that can be created in one step and then managed as a single entity. The Connector applies the provided document set content type on the folder. The document set content type includes several capabilities that make it easier to create and manage multi-document work products successfully.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">CREATEDOCUMENTSET(string listName, string folder, string contentType, [boolean recursive = false]);</p>
<p><strong>Example</strong>: to create folder <em>Images</em> as document set <em>CompanyImagesSet</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEDOCUMENTSET('Shared Documents', 'Images', 'CompanyImagesSet');</p>
<p>It is also possible to create document sets in existing folders.</p>
<p><strong>Example</strong>: to create subfolder <em>Logos</em> as document set <em>CompanyImagesSet</em> under folder <em>Images</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEDOCUMENTSET('Shared Documents', 'Images/Logos', 'CompanyImagesSet');</p>
<p>By default all parent folders must exist when creating subfolders. Use the <strong>recursive</strong> parameter to create all subfolders recursively. The document set content type will be applied on all subfolders.</p>
<p><strong>Example</strong>: to create subfolder <em>a/b/c/d</em> recursively as document set <em>CompanyImagesSet</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CREATEDOCUMENTSET('Shared Documents', 'a/b/c/d', 'CompanyImagesSet', true);</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create document set</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL CREATEDOCUMENTSET(&#39;Shared Documents&#39;, &#39;Images&#39;, &#39;CompanyImagesSet&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;ID = &quot; + command.LastInsertedId);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">ID = 874</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-upload"><i>/3_5/procedures/upload</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>UPLOAD</h1>

            
  
  <p>Used to upload a file into a document library.</p>
<p class="docnote"><strong>Note!</strong> For best performance in your application set the connection string option <strong>StreamBuffering </strong>to false. By default, this option is True because some SharePoint installations do not support pre-authentication. For the complete listing of options see <a href="#reference-connection-string-options">Connection String Options</a>.</p>
<p> <strong>Syntax</strong></p>
<p class="doccode">UPLOAD(string listName, string file, byte[] data);</p>
<p><strong>Example</strong>: to create a simple UTF-8 text file named <em>helloworld.txt</em> under folder <em>Textfiles</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL UPLOAD('Shared Documents', 'Textfiles/helloworld.txt', 'This is a small text file...');</p>
<p><strong>Example</strong>: to upload binary content, such as a jpg image, simply use:</p>
<pre class="csharpcode"><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Upload byte array</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL UPLOAD(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;, @doc)&quot;, connection))
    {
        command.Parameters.Add(&quot;@doc&quot;, System.IO.File.ReadAllBytes(@&quot;C:\bendsoft.jpg&quot;));
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div></pre>
<p class="docnote"><strong>Note!</strong> There is no built-in limitation in the Connector for how large files that can be uploaded. By default SharePoint allows a maximum file size of 50MB that can be uploaded into any document library.</p>
<p>To change the maximum file size in SharePoint 2010:</p>
<ul class="doclistnumeric">
<li>Login to SharePoint Central Administration.</li>
<li>Navigate to <strong>Central Administration</strong> -&gt; <strong>Application Management</strong> -&gt; <strong>Manage Web Applications</strong>.</li>
<li>Select the Web Application you want to change and then click on General Settings.</li>
<li>Locate the Maximum Upload Size setting and change the value according to your needs.</li>
</ul>
<p class="docnote"><strong>Note!</strong> Uploading very large files to SharePoint will often require an unwanted amount of memory resources. To overcome this issue, it is recommended to use the streaming approach demonstrated below.</p>
<p><strong>Example</strong>: to upload a large file on disk named <em>150Mb.bin</em> using the streaming method, write:</p>
<pre class="csharpcode"><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Upload stream input</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var fs = System.IO.File.OpenRead(@&quot;C:\150Mb.bin&quot;))
    {
        using (var command = new SharePointCommand(@&quot;CALL UPLOAD(&#39;Shared Documents&#39;, &#39;150Mb.bin&#39;, @doc)&quot;, connection))
        {
            command.Parameters.Add(&quot;@doc&quot;, fs);
            command.ExecuteNonQuery();
        }
    }
}</code></pre></div>
</div></pre>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-download"><i>/3_5/procedures/download</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DOWNLOAD</h1>

            
  
  <p>Used to download a file from a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>byte[]</strong> DOWNLOAD(string listName, string file, [double version = 0]);</p>
<p><strong>Example</strong>: to download the file named <em>helloworld.txt</em> from folder <em>Textfiles</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DOWNLOAD('Shared Documents', 'Textfiles/helloworld.txt');</p>
<p>It is also possible to download a specific version of a document if versioning has been enabled on the document library. Available versions can be listed with the <a href="#procedures-getversions">GETVERSIONS</a> procedure.</p>
<p><strong>Example</strong>: to download version 2.3 of the file named <em>helloworld.txt</em> from folder <em>Textfiles</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DOWNLOAD('Shared Documents', 'Textfiles/helloworld.txt', 2.3);</p>
<p>The procedure returns a scalar byte array that can be written to disk.</p>
<p><strong>Example</strong>: to download binary content, such as a png image, simply use:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Download document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DOWNLOAD(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        byte[] data = (byte[])command.ExecuteScalar();
        Console.WriteLine(&quot;Date length = &quot; + data.Length);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Date length = 20140</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-downloadinfopath"><i>/3_5/procedures/downloadinfopath</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DOWNLOADINFOPATH</h1>

            
  
  <p>Used specificity to download a <strong>InfoPath</strong> form from a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>byte[]</strong> DOWNLOADINFOPATH(string listName, string file, [double version = 0]);</p>
<p><strong>Example</strong>: to download the InfoPath form named my<em>form.xml</em> from document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DOWNLOADINFOPATH('Shared Documents', 'myform.xml');</p>
<p>It is also possible to download a specific version of a form if versioning has been enabled on the document library. Available versions can be listed with the <a href="#procedures-getversions">GETVERSIONS</a> procedure.</p>
<p><strong>Example</strong>: to download version 4.0 of the InfoPath form named <em>myform.xml</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DOWNLOADINFOPATH('Shared Documents', 'myform.xml', 4.0);</p>
<p>The procedure returns a scalar byte array that can be written to disk.</p>
<p><strong>Example</strong>: to download binary content, simply use:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Download InfoPath</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DOWNLOADINFOPATH(&#39;Shared Documents&#39;, &#39;myform.xml&#39;)&quot;, connection))
    {
        byte[] data = (byte[])command.ExecuteScalar();
        Console.WriteLine(&quot;Date length = &quot; + data.Length);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Date length = 7262</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-delete"><i>/3_5/procedures/delete</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DELETE</h1>

            
  
  <p>Used to delete a <strong>file</strong> or a <strong>folder</strong> from a document library.</p>
<p class="docnote"><strong>Note!</strong> When deleting a folder, all documents and subfolders under that folder will also be deleted.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">DELETE(string listName, string file);</p>
<p><strong>Example</strong>: to delete the file named <em>helloworld.txt</em> from folder <em>Textfiles</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL DELETE('Shared Documents', 'Textfiles/helloworld.txt');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DELETE(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-move"><i>/3_5/procedures/move</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>MOVE</h1>

            
  
  <p>Used to move a <strong>file</strong> or a <strong>folder</strong> from one document library to another or from one location to another within the same library.</p>
<p class="docnote"><strong>Note!</strong> When moving a folder, all documents and subfolders under that folder will also be moved. The name of the file or folder on the destination can be different from its original name.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">MOVE(string sourceListName, string sourceFile, string destinationListName, string destinationFile);</p>
<p><strong>Example</strong>: to move the file named <em>helloworld.txt</em> from folder <em>Textfiles</em> in document library <em>Shared Documents</em> to the root folder:</p>
<p class="doccode">CALL MOVE('Shared Documents', 'Textfiles/helloworld.txt', 'Shared Documents', 'helloworld.txt');</p>
<p><strong>Example</strong>: to move the folder named <em>Images</em> from document library <em>Shared Documents</em> to another document library called <em>New Shared Documents</em>:</p>
<p class="doccode">CALL MOVE('Shared Documents', 'Images', 'New Shared Documents', 'Images');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Move document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL MOVE(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;, &#39;Shared Documents&#39;, &#39;bendsoft.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-copy"><i>/3_5/procedures/copy</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>COPY</h1>

            
  
  <p>Used to copy a <strong>file</strong> or a <strong>folder</strong> from one document library to another or from one location to another within the same library.</p>
<p class="docnote"><strong>Note!</strong> When copying a folder, all documents and subfolders under that folder will also be copied. The name of the file or folder on the destination can be different from its original name.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">COPY(string sourceListName, string sourceFile, string destinationListName, string destinationFile);</p>
<p><strong>Example</strong>: to copy the file named <em>helloworld.txt</em> from folder <em>Textfiles</em> in document library <em>Shared Documents</em> to the root folder:</p>
<p class="doccode">CALL COPY('Shared Documents', 'Textfiles/helloworld.txt', 'Shared Documents', 'helloworld.txt');</p>
<p><strong>Example</strong>: to copy the folder named <em>Images</em> from document library <em>Shared Documents</em> to another document library called <em>New Shared Documents</em>:</p>
<p class="doccode">CALL COPY('Shared Documents', 'Images', 'New Shared Documents', 'Images');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Copy document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL COPY(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;, &#39;Shared Documents&#39;, &#39;Images/bendsoft_backup.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-rename"><i>/3_5/procedures/rename</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>RENAME</h1>

            
  
  <p>Used to rename a <strong>file</strong> or a <strong>folder</strong>.</p>
<p class="docnote"><strong>Note!</strong> If the destination folder is different from the original folder, the file or folder will be moved to the new location.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">RENAME(string listName, string sourceFile, string destinationFile);</p>
<p><strong>Example</strong>: to rename the file named <em>helloworld.txt</em> in document library <em>Shared Documents</em> to <em>helloworld_old.txt</em>:</p>
<p class="doccode">CALL RENAME('Shared Documents', 'helloworld.txt', 'helloworld_old.txt');</p>
<p><strong>Example</strong>: to rename the folder named <em>Images</em> in document library <em>Shared Documents</em> to <em>Images_old</em>:</p>
<p class="doccode">CALL RENAME('Shared Documents', 'Images', 'Images_old');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Rename document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL RENAME(&#39;Shared Documents&#39;, &#39;Images/bendsoft_backup.jpg&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-checkout"><i>/3_5/procedures/checkout</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CHECKOUT</h1>

            
  
  <p>Used to check-out a file in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>bool</strong> CHECKOUT(string listName, string file, bool offlineEditing [, datetime lastModified]);</p>
<p><em>offlineEditing</em>: Boolean value that indicates whether the file is to be flagged as checked out for offline editing.</p>
<p><em>lastModified</em>: Optional value representing the date and time of the last modification of the file. If this value is provided, the server compares the submitted value with the local last modified date. If the values do not match, the check-out fails and this procedure returns <strong>false</strong>.</p>
<p><strong>Return value</strong></p>
<p>The procedure returns <strong>true</strong> if operation succeeds, otherwise <strong>false</strong>.</p>
<p><strong>Example</strong>: to check-out the file named <em>helloworld.txt</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CHECKOUT('Shared Documents', 'helloworld.txt', true);</p>
<p><strong>Example</strong>: to check-out the file named <em>helloworld.txt</em> in document library <em>Shared Documents</em>, provided that the file has not changed since known date and time:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Check-out document</h4><div><pre class="prettyprint" lang="vb.net"><code>var lastModified = new DateTime();
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL CHECKOUT(&#39;Shared Documents&#39;, &#39;helloworld.txt&#39;, true, @lastmodified)&quot;, connection))
    {
        command.Parameters.Add(&quot;@lastmodified&quot;, lastModified);
        var ret = (bool)command.ExecuteScalar();

        if (ret)
            Console.WriteLine(&quot;Check-out succeeded&quot;);
        else
            Console.WriteLine(&quot;Check-out failed&quot;);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Check-out succeeded</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-checkin"><i>/3_5/procedures/checkin</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CHECKIN</h1>

            
  
  <p>Used to check-in a file in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>bool</strong> CHECKIN(string listName, string file, string comment, int checkInType);</p>
<p><em>comment</em>: Check-in comments.</p>
<p><em>checkInType</em>: Integer value indicating the check-in method used. Valid values are: 0 = MinorCheckIn, 1 = MajorCheckIn, and 2 = OverwriteCheckIn.</p>
<p><strong>Return value</strong></p>
<p>The procedure returns <strong>true</strong> if operation succeeds, otherwise <strong>false</strong>.</p>
<p><strong>Example</strong>: to check-in a major revision of the file named <em>helloworld.txt</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL CHECKIN('Shared Documents', 'helloworld.txt', 'Full revision', 1);</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Check-in document</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL CHECKIN(&#39;Shared Documents&#39;, &#39;helloworld.txt&#39;, &#39;Full revision&#39;, 1)&quot;, connection))
    {
        var ret = (bool)command.ExecuteScalar();

        if (ret)
            Console.WriteLine(&quot;Check-in succeeded&quot;);
        else
            Console.WriteLine(&quot;Check-out failed&quot;);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Check-in succeeded</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-undocheckout"><i>/3_5/procedures/undocheckout</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>UNDOCHECKOUT</h1>

            
  
  <p>Used to undo the check-out of a file in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>bool</strong> UNDOCHECKOUT(string listName, string file);</p>
<p><strong>Return value</strong></p>
<p>The procedure returns <strong>true</strong> if operation succeeds, otherwise <strong>false</strong>.</p>
<p><strong>Example</strong>: to undo the check-out of the file named <em>helloworld.txt</em> in document library <em>Shared Documents</em>:</p>
<p class="doccode">CALL UNDOCHECKOUT('Shared Documents', 'helloworld.txt');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Undo check-out</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL UNDOCHECKOUT(&#39;Shared Documents&#39;, &#39;helloworld.txt&#39;)&quot;, connection))
    {
        var ret = (bool)command.ExecuteScalar();

        if (ret)
            Console.WriteLine(&quot;Undo check-out succeeded&quot;);
        else
            Console.WriteLine(&quot;Undo check-out failed&quot;);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Undo check-out succeeded</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-getversions"><i>/3_5/procedures/getversions</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>GETVERSIONS</h1>

            
  
  <p>Used to list all versions of a specific document in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> GETVERSIONS(string listName, string file);</p>
<p><strong>Return value</strong></p>
<p>The procedure returns a list of versions with the following columns.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>Version</td>
<td>System.String</td>
<td>Version number, e.g. "1.0". Current version always starts with '@'.</td>
</tr>
<tr>
<td>Url</td>
<td>System.String</td>
<td>The full URL of the document version</td>
</tr>
<tr>
<td>Created</td>
<td>System.DateTime</td>
<td>Date of creation</td>
</tr>
<tr>
<td>CreatedBy</td>
<td>System.String</td>
<td>Name of creator</td>
</tr>
<tr>
<td>Size</td>
<td>System.String</td>
<td>Size of document</td>
</tr>
<tr>
<td>Comments</td>
<td>System.String</td>
<td>Optional comments provided by the creator</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to get all versions of document <em>Cats.docx</em> from folder <em>Latest</em> in library <em>Animals</em>:</p>
<p class="doccode">CALL GETVERSIONS('Animals', 'Latest/Cats.docx');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Get document versions</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL GETVERSIONS(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(&quot;Version: &quot; + reader[&quot;Version&quot;].ToString());
                Console.WriteLine(&quot;Created: &quot; + reader[&quot;Created&quot;].ToString());
                Console.WriteLine(&quot;CreatedBy: &quot; + reader[&quot;CreatedBy&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Version: @1.0<br>Created: 2013-01-01 12:34:22<br>CreatedBy: John Smith</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-deleteversion"><i>/3_5/procedures/deleteversion</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DELETEVERSION</h1>

            
  
  <p>Used to delete a specific version of a specific document in a document library.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> DELETEVERSION(string listName, string file, double version);</p>
<p><strong>Return value</strong></p>
<p>After deletion the procedure returns a list of remaining versions with the following columns.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>Version</td>
<td>System.String</td>
<td>Version number, e.g. "1.0". Current version always starts with '@'.</td>
</tr>
<tr>
<td>Url</td>
<td>System.String</td>
<td>The full URL of the document version</td>
</tr>
<tr>
<td>Created</td>
<td>System.DateTime</td>
<td>Date of creation</td>
</tr>
<tr>
<td>CreatedBy</td>
<td>System.String</td>
<td>Name of creator</td>
</tr>
<tr>
<td>Size</td>
<td>System.String</td>
<td>Size of document</td>
</tr>
<tr>
<td>Comments</td>
<td>System.String</td>
<td>Optional comments provided by the creator</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to delete version 2.0 of document <em>Cats.docx</em> from folder <em>Latest</em> in library <em>Animals</em>:</p>
<p class="doccode">CALL DELETEVERSION('Animals', 'Latest/Cats.docx', 2.0);</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete document version</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DELETEVERSION(&#39;Shared Documents&#39;, &#39;Files/Serverlist.txt&#39;, 2.0)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(&quot;Version: &quot; + reader[&quot;Version&quot;].ToString());
                Console.WriteLine(&quot;Created: &quot; + reader[&quot;Created&quot;].ToString());
                Console.WriteLine(&quot;CreatedBy: &quot; + reader[&quot;CreatedBy&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Version: @3.0<br>Created: 2013-01-12 16:01:12<br>CreatedBy: Adam Sandler<br>Version: 1.0<br>Created: 2013-01-12 07:16:26<br>CreatedBy: Abe Lincoln</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-deleteallversions"><i>/3_5/procedures/deleteallversions</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DELETEALLVERSIONS</h1>

            
  
  <p>Used to delete all versions of a specific document in a document library. The current version will always remain after calling this procedure.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> DELETEALLVERSIONS(string listName, string file);</p>
<p><strong>Return value</strong></p>
<p>After deletion the procedure returns a list containing the current version only with the following columns.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>Version</td>
<td>System.String</td>
<td>Version number, e.g. "1.0". Current version always starts with '@'.</td>
</tr>
<tr>
<td>Url</td>
<td>System.String</td>
<td>The full URL of the document version</td>
</tr>
<tr>
<td>Created</td>
<td>System.DateTime</td>
<td>Date of creation</td>
</tr>
<tr>
<td>CreatedBy</td>
<td>System.String</td>
<td>Name of creator</td>
</tr>
<tr>
<td>Size</td>
<td>System.String</td>
<td>Size of document</td>
</tr>
<tr>
<td>Comments</td>
<td>System.String</td>
<td>Optional comments provided by the creator</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to delete all versions of document <em>Cats.docx</em> from folder <em>Latest</em> in library <em>Animals</em>:</p>
<p class="doccode">CALL DELETEALLVERSIONS('Animals', 'Latest/Cats.docx');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete all document versions</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DELETEALLVERSIONS(&#39;Shared Documents&#39;, &#39;Images/bendsoft.jpg&#39;)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(&quot;Version: &quot; + reader[&quot;Version&quot;].ToString());
                Console.WriteLine(&quot;Created: &quot; + reader[&quot;Created&quot;].ToString());
                Console.WriteLine(&quot;CreatedBy: &quot; + reader[&quot;CreatedBy&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Version: @5.5<br>Created: 2013-01-12 07:16:26<br>CreatedBy: Adam Sandler</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-restoreversion"><i>/3_5/procedures/restoreversion</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>RESTOREVERSION</h1>

            
  
  <p>Used to restore a specific version of a specific document in a document library. This will replace the current version of the document with the restored version.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> RESTOREVERSION(string listName, string file, double version);</p>
<p><strong>Return value</strong></p>
<p>After restoration the procedure returns a list of versions with the following columns.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>Version</td>
<td>System.String</td>
<td>Version number, e.g. "1.0". Current version always starts with '@'.</td>
</tr>
<tr>
<td>Url</td>
<td>System.String</td>
<td>The full URL of the document version</td>
</tr>
<tr>
<td>Created</td>
<td>System.DateTime</td>
<td>Date of creation</td>
</tr>
<tr>
<td>CreatedBy</td>
<td>System.String</td>
<td>Name of creator</td>
</tr>
<tr>
<td>Size</td>
<td>System.String</td>
<td>Size of document</td>
</tr>
<tr>
<td>Comments</td>
<td>System.String</td>
<td>Optional comments provided by the creator</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to restore version 2.0 of document <em>Cats.docx</em> from folder <em>Latest</em> in library <em>Animals</em>:</p>
<p class="doccode">CALL RESTOREVERSION('Animals', 'Latest/Cats.docx', 2.0);</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Restore document version</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL RESTOREVERSION(&#39;Shared Documents&#39;, &#39;Files/Serverlist.txt&#39;, 1.0)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(&quot;Version: &quot; + reader[&quot;Version&quot;].ToString());
                Console.WriteLine(&quot;Created: &quot; + reader[&quot;Created&quot;].ToString());
                Console.WriteLine(&quot;CreatedBy: &quot; + reader[&quot;CreatedBy&quot;].ToString());
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Version: @3.0<br>Created: 2013-01-12 16:01:12<br>CreatedBy: Adam Sandler<br>Version: 2.0<br>Created: 2013-01-12 15:12:54<br>CreatedBy: Abe Lincoln<br>Version: 1.0<br>Created: 2013-01-12 07:16:26<br>CreatedBy: Abe Lincoln</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-downloadattachment"><i>/3_5/procedures/downloadattachment</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DOWNLOADATTACHMENT</h1>

            
  
  <p>Used to download one or more attachments of a list item, optionally specifying filename.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> DOWNLOADATTACHMENT(string listName, int itemId, bool includeData, [string fileName = null]);</p>
<p><em>includeData</em>: Boolean value that indicates if column <strong>Data</strong> is included in the results.</p>
<p><em>fileName</em>: File name of attachment to download (optional).</p>
<p><strong>Return value</strong></p>
<p>The procedure returns a list of attachments with the following columns.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>ServerUrl</td>
<td>System.String</td>
<td>The full server URL to the file</td>
</tr>
<tr>
<td>FileName</td>
<td>System.String</td>
<td>Filename of attachment including extension</td>
</tr>
<tr>
<td>ItemID</td>
<td>System.Int32</td>
<td>The ID of the associated item in the list</td>
</tr>
<tr>
<td>Data</td>
<td>System.Byte[]</td>
<td>File content if <em>includeData</em> is true</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to download all attachments of item 12 in list <em>Meals</em>:</p>
<p class="doccode">CALL DOWNLOAD('Meals', 12, true);</p>
<p><strong>Example</strong>: to download the attachment with filename <em>Recipe.doc</em> of item 12 in list <em>Meals</em>:</p>
<p class="doccode">CALL DOWNLOAD('Meals', 12, true, 'Recipe.doc');</p>
<h2>Code examples</h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Download attachments</h4><div><pre class="prettyprint" lang="vb.net"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DOWNLOADATTACHMENT(&#39;Meals&#39;, 12, true)&quot;, connection))
    {
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(&quot;Writing file: &quot; + reader[&quot;FileName&quot;].ToString());

                var data = (byte[])reader[&quot;Data&quot;];
                System.IO.File.WriteAllBytes(@&quot;c:\&quot; + reader[&quot;FileName&quot;].ToString(), data);
            }
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Writing file: Receipt.doc<br>Writing file: Image.png</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-uploadattachment"><i>/3_5/procedures/uploadattachment</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>UPLOADATTACHMENT</h1>

            
  
  <p>Used to upload an attachment to a list item.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">UPLOADATTACHMENT(string listName, int itemId, string fileName, byte[] data);</p>
<p><strong>Example</strong>: to create a simple UTF-8 text file named <em>helloworld.txt</em> to list item 3 in list <em>Files</em>:</p>
<p class="doccode">CALL UPLOADATTACHMENT('Files', 3, 'helloworld.txt', 'This is a small text file...');</p>
<p><strong>Example</strong>: to upload binary content, such as a jpg image, simply use:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Upload attachment</h4><div><pre class="prettyprint" lang="vb.net"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL UPLOADATTACHMENT(&#39;Files&#39;, 3, &#39;bendsoft.jpg&#39;, @doc)&quot;, connection))
    {
        command.Parameters.Add(&quot;@doc&quot;, System.IO.File.ReadAllBytes(@&quot;C:\bendsoft.jpg&quot;));
        command.ExecuteNonQuery();
    }
}</code></pre></div>
</div>
<p class="docnote"><strong>Note!</strong> Uploading very large files to SharePoint will often require an unwanted amount of memory resources. To overcome this issue, it is recommended to use the streaming approach demonstrated below.</p>
<p><strong>Example</strong>: to upload a large file on disk named <em>150Mb.bin</em> using the streaming method, write:</p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Upload attachment stream input</h4><div><pre class="prettyprint" lang="vb.net"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var fs = System.IO.File.OpenRead(@&quot;C:\150Mb.bin&quot;))
    {
        using (var command = new SharePointCommand(@&quot;CALL UPLOADATTACHMENT(&#39;Files&#39;, 44, &#39;150Mb.bin&#39;, @doc)&quot;, connection))
        {
            command.Parameters.Add(&quot;@doc&quot;, fs);
            command.ExecuteNonQuery();
        }
    }
}</code></pre></div>
</div>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-deleteattachment"><i>/3_5/procedures/deleteattachment</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>DELETEATTACHMENT</h1>

            
  
  <p>Used to delete an attachment from a list item.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">DELETEATTACHMENT(string listName, int itemId, string fileName);</p>
<p><strong>Example</strong>: to delete attachment file named <em>helloworld.txt</em> from list item 3 in list <em>Files</em>:</p>
<p class="doccode">CALL DELETEATTACHMENT('Files', 3, 'helloworld.txt');</p>
<h2><strong>Code examples</strong></h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Delete attachment</h4><div><pre class="prettyprint" lang="vb.net"><code>var connectionString = @&quot;Server=mysharepointserver.com;User=spuser;Password=******;Database=sitename;Authentication=Ntlm;&quot;;
using (var connection = new SharePointConnection(connectionString))
{
    connection.Open();
    using (var command = new SharePointCommand(@&quot;CALL DELETEATTACHMENT(&#39;Files&#39;, 3, &#39;helloworld.txt&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Last affected: &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Last affected: 1</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-getcolumnversions"><i>/3_5/procedures/getcolumnversions</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>GETCOLUMNVERSIONS</h1>

            
  
  <p>Used to select all versions of one or more columns from a list that has versioning enabled in SharePoint. The normal SELECT statement only retrieves the current value. This procedure can be used to retrieve the history of a column for a given item in the list.</p>
<p class="docnote"><strong>Note!</strong> Due to the way SharePoint works, retrieving versions of a column is a significantly more expensive operation compared to normal SELECT statements. The total time will increase quickly with the number of columns added to the query. It is not recommended to use this method to iterate through large lists on regular basis.</p>
<p><strong>Syntax</strong></p>
<p class="doccode"><strong>resultset</strong> GETCOLUMNVERSIONS(string listName, int itemId, string columnNames);</p>
<p><strong>Return value</strong></p>
<p>The procedure returns a list of versions where each column in <em>columnNames</em> is represented. The two first columns in the resultset are fixed and tell when each version was created and by who.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Column</th><th>.NET Data Type</th><th>Description</th></tr>
<tr>
<td>Modified</td>
<td>System.DateTime</td>
<td>Date of modification</td>
</tr>
<tr>
<td>Editor</td>
<td>System.Integer</td>
<td>User ID of the editor</td>
</tr>
<tr>
<td>Variable column 1</td>
<td>Variable data type</td>
<td>Column 1</td>
</tr>
<tr>
<td>Variable column 2</td>
<td>Variable data type</td>
<td>Column 2</td>
</tr>
<tr>
<td>...</td>
<td>Variable data type</td>
<td>...</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: to select all versions of column <em>Email</em> from list item 76 in list <em>Customers</em>:</p>
<p class="doccode">CALL GETCOLUMNVERSIONS('Customers', 76, 'Email');</p>
<p><strong>Example</strong>: to select all versions of column <em>Email</em> AND <em>Mobile</em> from list item 76 in list <em>Customers</em>:</p>
<p class="doccode">CALL GETCOLUMNVERSIONS('Customers', 76, 'Email, Mobile');</p>
<h2><strong>Code examples</strong></h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Select all versions</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;CALL GETCOLUMNVERSIONS(&#39;Customers&#39;, 58, &#39;Title, Email&#39;)&quot;, connection))
{
    using (var reader = command.ExecuteReader())
    {
        while (reader.Read())
        {
            Console.WriteLine(reader[&quot;Modified&quot;].ToString().PadRight(20) + &quot; : &quot; + reader[&quot;Title&quot;].ToString().PadRight(20) + &quot; : &quot; + reader[&quot;Email&quot;].ToString());
        }
    }
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">2013-10-02 23:56:15  : Steve                : steve.h@bendsoft.com<br>2013-10-02 23:56:01  : Steve                : stevie@bendsoft.com<br>2013-09-27 00:16:02  : Steve                : steve@bendsoft.com</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-createlistfromtemplate"><i>/3_5/procedures/createlistfromtemplate</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>CREATELISTFROMTEMPLATE</h1>

            
  
  <p>Creates a list in the current site based on the specified list name, description and list template name, optionally providing a feature ID. The template name must be one of the predefined values listed.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">CREATELISTFROMTEMPLATE(string listName, string description, string templateName [, GUID featureId]);</p>
<p><strong>Return value</strong></p>
<p>This method does not return any value.</p>
<p><strong>Example</strong>: to create a new document library called <em>Company documents</em>:</p>
<p class="doccode">CALL CREATELISTFROMTEMPLATE('Company documents', 'Important documents', 'Document Library');</p>
<p><strong>Templates</strong></p>
<p>The following templates can be used with this method.</p>
<table border="0" class="doctable">
<tbody>
<tr><th>Template name</th></tr>
<tr>
<td>Announcements</td>
</tr>
<tr>
<td>Contacts</td>
</tr>
<tr>
<td>Custom List</td>
</tr>
<tr>
<td>Custom List in Datasheet View</td>
</tr>
<tr>
<td>DataSources</td>
</tr>
<tr>
<td>Discussion Board</td>
</tr>
<tr>
<td>Document Library</td>
</tr>
<tr>
<td>Events</td>
</tr>
<tr>
<td>Form Library</td>
</tr>
<tr>
<td>Issues</td>
</tr>
<tr>
<td>Links</td>
</tr>
<tr>
<td>Picture Library</td>
</tr>
<tr>
<td>Survey</td>
</tr>
<tr>
<td>Tasks</td>
</tr>
</tbody>
</table>
<h2><strong>Code examples</strong></h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Create list</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;CALL CREATELISTFROMTEMPLATE(&#39;Zoo animals&#39;, &#39;Animal pictures&#39;, &#39;Picture Library&#39;)&quot;, connection))
{
    command.ExecuteNonQuery();
    Console.WriteLine(&quot;Last affected: &quot; + command.LastRecordsAffected);
}</code></pre></div>
</div>
<p><strong>Code result</strong></p>
<p class="code">Last affected: 1</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-setreadwrite"><i>/3_5/procedures/setreadwrite</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SETREADWRITE</h1>

            
  
  <p>SETREADWRITE and SETREADONLY are two very special procedures that can be used to allow modfying columns that SharePoint normally does not allow to be modified, such as the <em>Modifed</em> and <em>Create</em> columns in a list. It can for example be useful in backup/restore scenarios. These procedures are not guaranteed to work on all columns. Sealed columns and columns of type COUNTER, cannot as an example, be modified.</p>
<p><strong>SETREADWRITE</strong> in particular is used to set ReadWrite access on one or more columns.</p>
<p class="docnote"><strong>Note!</strong> It is very important to understand that the SETREADWRITE and SETREADONLY procedures both make changes to the list schema and must be used carefully. A SETREADWRITE operation on column that is by default ReadOnly should be followed by a SETREADONLY command in order to restore the column access. It is not recommended to use these procedures excessively and only in controlled environments.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SETREADWRITE(string listName, string columnNames);</p>
<p><strong>Return value</strong></p>
<p>This method does not return any value.</p>
<p><strong>Example</strong>: to set ReadWrite access on the columns <em>Modified</em> and <em>Created</em> in the list <em>Customers</em>:</p>
<p class="doccode">CALL SETREADWRITE('Customers', 'Modified, Created');</p>
<h2><strong><strong>Code examples</strong></strong></h2>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Update the modified and created columns</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;CALL SETREADWRITE(&#39;Customers&#39;, &#39;Modified, Created&#39;)&quot;, connection))
{
    command.ExecuteNonQuery();
    Console.WriteLine(&quot;SETREADWRITE: &quot; + command.LastRecordsAffected);
}

try
{
    using (var command = new SharePointCommand(&quot;UPDATE Customers SET Modified = &#39;19801025123000&#39;, Created = &#39;19801025123000&#39; WHERE ID = 1&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Last affected: &quot; + command.LastRecordsAffected);
    }
}
finally
{
    using (var command = new SharePointCommand(&quot;CALL SETREADONLY(&#39;Customers&#39;, &#39;Modified, Created&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;SETREADONLY: &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p>The above example shows how the SETREADWRITE and SETREADONLY can be used to modify columns that are normally ReadOnly.</p>
<p><strong>Code result</strong></p>
<p class="code">SETREADWRITE: 1<br>Last affected: 1<br>SETREADONLY: 1</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="procedures-setreadonly"><i>/3_5/procedures/setreadonly</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SETREADONLY</h1>

            
  
  <p>SETREADWRITE and SETREADONLY are two very special procedures that can be used to allow modfying columns that SharePoint normally does not allow to be modified, such as the <em>Modifed</em> and <em>Create</em> columns in a list. It can for example be useful in backup/restore scenarios. These procedures are not guaranteed to work on all columns. Sealed columns and columns of type COUNTER, cannot as an example, be modified.</p>
<p><strong>SETREADONLY</strong> in particular is used to set ReadOnly access on one or more columns.</p>
<p class="docnote"><strong>Note!</strong> It is very important to understand that the SETREADWRITE and SETREADONLY procedures both make changes to the list schema and must be used carefully. A SETREADWRITE operation on column that is by default ReadOnly should be followed by a SETREADONLY command in order to restore the column access. It is not recommended to use these procedures excessively and only in controlled environments.</p>
<p><strong>Syntax</strong></p>
<p class="doccode">SETREADONLY(string listName, string columnNames);</p>
<p><strong>Return value</strong></p>
<p>This method does not return any value.</p>
<p><strong>Example</strong>: to set ReadOnly access on the columns <em>Modified</em> and <em>Created</em> in the list <em>Customers</em>:</p>
<p class="doccode">CALL SETREADONLY('Customers', 'Modified, Created');</p>
<p><strong><strong><strong>Code examples</strong></strong></strong></p>
<p><div id="ContentPlaceHolderDefault_MainContent_container">
	<h4>Update the modified and created columns</h4><div><pre class="prettyprint" lang="vb.net"><code>using (var command = new SharePointCommand(&quot;CALL SETREADWRITE(&#39;Customers&#39;, &#39;Modified, Created&#39;)&quot;, connection))
{
    command.ExecuteNonQuery();
    Console.WriteLine(&quot;SETREADWRITE: &quot; + command.LastRecordsAffected);
}

try
{
    using (var command = new SharePointCommand(&quot;UPDATE Customers SET Modified = &#39;19801025123000&#39;, Created = &#39;19801025123000&#39; WHERE ID = 1&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;Last affected: &quot; + command.LastRecordsAffected);
    }
}
finally
{
    using (var command = new SharePointCommand(&quot;CALL SETREADONLY(&#39;Customers&#39;, &#39;Modified, Created&#39;)&quot;, connection))
    {
        command.ExecuteNonQuery();
        Console.WriteLine(&quot;SETREADONLY: &quot; + command.LastRecordsAffected);
    }
}</code></pre></div>
</div>
<p>The above example shows how the SETREADWRITE and SETREADONLY can be used to modify columns that are normally ReadOnly.</p>
<p><strong>Code result</strong></p>
<p class="code">SETREADWRITE: 1<br>Last affected: 1<br>SETREADONLY: 1</p>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="3_5-reference"><i>/3_5/reference</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Reference</h1>

            
  
  <p>This chapter contains various reference tables for the Camelot .NET Connector.</p>
  
  

        </div><hr/></div><div id="section"><a name="reference-show-databases"><i>/3_5/reference/show-databases</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW DATABASES</h1>

            
  
  <p>Also read the <a href="#sql-statement-syntax-show-databases">SQL statement syntax on SHOW DATABASES</a></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>Name</td>
<td>String</td>
<td>Site name</td>
</tr>
<tr>
<td>Url</td>
<td>String</td>
<td>Absolute site url</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-show-tables"><i>/3_5/reference/show-tables</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW TABLES</h1>

            
  
  <p>Also read the <a href="#sql-statement-syntax-show-tables" title="SHOW TABLES">SQL statement syntax on SHOW TABLES</a></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>ID</td>
<td>GUID</td>
<td>Internal list GUID. This property never change and can be used to query the list in replacement of list title.</td>
</tr>
<tr>
<td>Name</td>
<td>String</td>
<td>Internal list name.</td>
</tr>
<tr>
<td>Title</td>
<td>String</td>
<td>List title. Is normally used to query the list.</td>
</tr>
<tr>
<td>Description</td>
<td>String</td>
<td>Description of the list and its content.</td>
</tr>
<tr>
<td>Created</td>
<td>DateTime</td>
<td>Indicates when the list was created.</td>
</tr>
<tr>
<td>Modified</td>
<td>DateTime</td>
<td>Indicates when the list was last modified.</td>
</tr>
<tr>
<td>LastDeleted</td>
<td>DateTime</td>
<td>Indicates when an item was last deleted from the list.</td>
</tr>
<tr>
<td>ItemCount</td>
<td>Int32</td>
<td>Indicates the current number of items in the list.</td>
</tr>
<tr>
<td>AllowDeletion</td>
<td>Boolean</td>
<td>True if items can be deleted from the list.</td>
</tr>
<tr>
<td>EnableAttachments</td>
<td>Boolean</td>
<td>True if the list allows attachments on items.</td>
</tr>
<tr>
<td>RequireCheckout</td>
<td>Boolean</td>
<td>True if items must be checked out before they can be modified.</td>
</tr>
<tr>
<td>ReadSecurity</td>
<td>Int32</td>
<td>Indicates the Read security setting for the list.<br> [1]: All users have Read access to all items.<br> [2]: Users have Read access only to items that they create.</td>
</tr>
<tr>
<td>WriteSecurity</td>
<td>Int32</td>
<td>Indicates the Write security setting for the list.<br> [1]: All users have Write access to all items.<br> [2]: Users have Write access only to items that they create.<br> [3]: Users cannot modify any items.</td>
</tr>
<tr>
<td>Hidden</td>
<td>Boolean</td>
<td>Indicates if the list is hidden. Hidden lists do not appear on the lists page or as option for lookup fields in SharePoint.</td>
</tr>
<tr>
<td>ShowUser</td>
<td>Boolean</td>
<td>Indicates if names of users are shown in the list.</td>
</tr>
<tr>
<td>Author</td>
<td>Int32</td>
<td>The ID of the user who created the list.</td>
</tr>
<tr>
<td>DefaultViewUrl</td>
<td>String</td>
<td>The relative URL of the default view for the list.</td>
</tr>
<tr>
<td>MobileDefaultViewUrl</td>
<td>String</td>
<td>The relative URL of the mobile default view for the list.</td>
</tr>
<tr>
<td>ImageUrl</td>
<td>String</td>
<td>The relative URL of the icon that represents the list.</td>
</tr>
<tr>
<td>BaseType</td>
<td>Int32</td>
<td>Indicates the base type of the list.<br> [0]: Generic list<br> [1]: Document library<br> [2]: Reserved, not used<br> [3]: Discussion board<br> [4]: Survey list<br> [5]: Issue tracking list</td>
</tr>
<tr>
<td>Version</td>
<td>Int32</td>
<td>The version number of the list. This version is automatically incremented when the list defintion is changed.</td>
</tr>
<tr>
<td>EnableModeration</td>
<td>Boolean</td>
<td>True if content approval is enabled for the list.</td>
</tr>
<tr>
<td>EnableVersioning</td>
<td>Boolean</td>
<td>True if versioning is enabled to the document library.</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-show-columns"><i>/3_5/reference/show-columns</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW COLUMNS</h1>

            
  
  <p>Also read the <a href="#sql-statement-syntax-show-columns">SQL statement syntax on SHOW COLUMNS</a></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>ID</td>
<td>GUID</td>
<td>Internal column GUID</td>
</tr>
<tr>
<td>Name</td>
<td>String</td>
<td>Internal column name. This name never changes after column has been created.</td>
</tr>
<tr>
<td>DecodedName</td>
<td>String</td>
<td>Internal column name XML decoded</td>
</tr>
<tr>
<td>DisplayName</td>
<td>String</td>
<td>The column display title as shown in SharePoint</td>
</tr>
<tr>
<td>Type</td>
<td>String</td>
<td>The column type. Some of the possible types are:
<ul>
<li>Guid (Guid)</li>
<li>Text, Note, URL, ContentTypeId, Computed (String)</li>
<li>Choice (String)</li>
<li>MultiChoice (String[])</li>
<li>Boolean, Attachments, CrossProjectLink, Recurrence, AlldayEvent (Boolean)</li>
<li>DateTime (DateTime)</li>
<li>Integer, Counter, ModStat (Int32)</li>
<li>User, Lookup (Int32)</li>
<li>UserMulti, LookupMulti (Int32[])</li>
<li>Number, Currency (Double)</li>
<li>Calculated (Object)</li>
<li>BusinessData (String)</li>
</ul>
</td>
</tr>
<tr>
<td>MaxLength</td>
<td>Integer</td>
<td>For text columns, the maximum allowed length of column content</td>
</tr>
<tr>
<td>Required</td>
<td>Boolean</td>
<td>Indicates if this column is required, thus cannot be empty (NULL)</td>
</tr>
<tr>
<td>ReadOnly</td>
<td>Boolean</td>
<td>Indicates if the column can be updated</td>
</tr>
<tr>
<td>PrimaryKey</td>
<td>Boolean</td>
<td>Indicates if the column is the primary key of the list. This is typically the ID column.</td>
</tr>
<tr>
<td>Min</td>
<td>Double</td>
<td>For numerics, the minimum allowed value</td>
</tr>
<tr>
<td>Max</td>
<td>Double</td>
<td>For numerics, the maximum allowed value</td>
</tr>
<tr>
<td>Decimals</td>
<td>Double</td>
<td>For numerics, the number if decimal places</td>
</tr>
<tr>
<td>Percentage</td>
<td>Boolean</td>
<td>For numerics, indicates if column represents a percentage value</td>
</tr>
<tr>
<td>EnumValues</td>
<td>String</td>
<td>For MultiChoice columns, indicates possible values for the column, e.g. [Apple][Pear][Orange]</td>
</tr>
<tr>
<td>Format</td>
<td>String</td>
<td>For Date columns, indicates the date/time format. Possbile values are:
<ul>
<li>DateOnly</li>
<li>DateTime</li>
<li>ISO8601</li>
<li>ISO8601Basic</li>
</ul>
For Choice columns, indicates the editing style and can be set to:
<ul>
<li>DropDown (default)</li>
<li>RadioButtons</li>
</ul>
For URL columns, indicates the link style and can be set to:
<ul>
<li>Hyperlink (default)</li>
<li>Image</li>
</ul>
</td>
</tr>
<tr>
<td>ResultType</td>
<td>String</td>
<td>For Calculated columns, specifies the data type of values returned</td>
</tr>
<tr>
<td>List</td>
<td>String</td>
<td>For Lookup columns, specifies the internal name of a list</td>
</tr>
<tr>
<td>ShowField</td>
<td>String</td>
<td>For lookup columns, specifies the internal name of a foreign column to display</td>
</tr>
<tr>
<td>RichText</td>
<td>Boolean</td>
<td>For Note columns, indicates if RichText formatting is allowed</td>
</tr>
<tr>
<td>RichTextMode</td>
<td>String</td>
<td>For Note columns, can be set to FullHtml</td>
</tr>
<tr>
<td>VisibleInView</td>
<td>Boolean</td>
<td>Indicates if the column is visible in the given view</td>
</tr>
<tr>
<td>AppendOnly</td>
<td>Boolean</td>
<td>Indicates if values are automatically appended to the column on UPDATE</td>
</tr>
<tr>
<td>AuthoringInfo</td>
<td>String</td>
<td>Provides a descriptive text that can be used to clarify the purpose of the column</td>
</tr>
<tr>
<td>Aggregation</td>
<td>String</td>
<td>Indicates the aggregation of value in the column</td>
</tr>
<tr>
<td>Div</td>
<td>Double</td>
<td>For numerics, indicates the scale factor before displaying numbers</td>
</tr>
<tr>
<td>FieldRef</td>
<td>String</td>
<td>For Lookup columns, specifies the name of an internal field to which the field refers</td>
</tr>
<tr>
<td>FillInChoice</td>
<td>Boolean</td>
<td>For Choice columns, indicates if users can fill in values</td>
</tr>
<tr>
<td>HTMLEncode</td>
<td>Boolean</td>
<td>Indicates true if text is HTML encoded in this column</td>
</tr>
<tr>
<td>Mult</td>
<td>Boolean</td>
<td>For numerics, indicates the multiplication before displaying numbers</td>
</tr>
<tr>
<td>NegativeFormat</td>
<td>String</td>
<td>For numerics, indicates how negative values are indicates and can be:
<ul>
<li>MinusSign</li>
<li>Parens (surround with parenthesis)</li>
</ul>
</td>
</tr>
<tr>
<td>NumLines</td>
<td>Integer</td>
<td>Indicates the number of lines to display in edit mode</td>
</tr>
<tr>
<td>Filterable</td>
<td>Boolean</td>
<td>Indicates if column can be filtered, i.e. can be used in WHERE clause</td>
</tr>
<tr>
<td>Sortable</td>
<td>Boolean</td>
<td>Indicates if column is sortable, i.e. can be used in ORDER BY clause</td>
</tr>
<tr>
<td>LCID</td>
<td>Integer</td>
<td>Indicates the region format</td>
</tr>
<tr>
<td>Description</td>
<td>String</td>
<td>Column description</td>
</tr>
<tr>
<td>Group</td>
<td>String</td>
<td>Specifies the column group to which column belongs</td>
</tr>
<tr>
<td>SystemInstance</td>
<td>String</td>
<td>Businessdata property</td>
</tr>
<tr>
<td>Entity</td>
<td>String</td>
<td>Businessdata property</td>
</tr>
<tr>
<td>BdcField</td>
<td>String</td>
<td>Businessdata property</td>
</tr>
<tr>
<td>SecondaryFieldBdcNames</td>
<td>String</td>
<td>Businessdata property</td>
</tr>
<tr>
<td>RelatedField</td>
<td>String</td>
<td>Businessdata property</td>
</tr>
<tr>
<td>Default</td>
<td>String</td>
<td>Default value of the column</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-show-views"><i>/3_5/reference/show-views</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW VIEWS</h1>

            
  
  <p>Also read the <a href="#sql-statement-syntax-show-views">SQL statement syntax on SHOW VIEWS</a></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>ID</td>
<td>GUID</td>
<td>Internal view GUID</td>
</tr>
<tr>
<td>DisplayName</td>
<td>String</td>
<td>The view display title as shown in SharePoint</td>
</tr>
<tr>
<td>DefaultView</td>
<td>Boolean</td>
<td>Indicates if this is the default view of the list</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-show-contenttypes"><i>/3_5/reference/show-contenttypes</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>SHOW CONTENTTYPES</h1>

            
  
  <p>Also read the <a href="#sql-statement-syntax-show-contenttypes">SQL statement syntax on SHOW CONTENTTYPES</a></p>
<table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>ID</td>
<td>GUID</td>
<td>Internal content type GUID</td>
</tr>
<tr>
<td>Name</td>
<td>String</td>
<td>The content type display title as shown in SharePoint</td>
</tr>
<tr>
<td>Description</td>
<td>String</td>
<td>Description of the content type</td>
</tr>
<tr>
<td>Scope</td>
<td>String</td>
<td>Indicates the scope of the content type</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-connection-string-options"><i>/3_5/reference/connection-string-options</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Connection String Options</h1>

            
  
  <table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>Default</th><th>Description</th></tr>
<tr>
<td>Server</td>
<td>-</td>
<td>The IP or hostname of the SharePoint server. Required.<br> Example: localhost, 192.168.0.1, http://mysharepointsite.com, https://mysharepointsite.com<br>
<ul>
<li>You can add the https:// prefix to enable SSL/TLS encryption and override the SSL option.</li>
<li>You can specify the port to use in the server string, for example: 192.168.0.1:81 or https://mysharepointsite.com:444.</li>
</ul>
</td>
</tr>
<tr>
<td>Database</td>
<td>-</td>
<td>Corresponds to a site path on the SharePoint server, e.g. "marketing" or "marketing/news".<br> This site is where your lists and libraries will be selected from. Leave empty to select the top site.</td>
</tr>
<tr>
<td>User</td>
<td>-</td>
<td>User name of the account used to access SharePoint. This account must have sufficient privileges to access the provided site. Required when server uses authentication mode [Ntlm] or [Basic].</td>
</tr>
<tr>
<td>Password</td>
<td>-</td>
<td>SharePoint account password.</td>
</tr>
<tr>
<td>Domain</td>
<td>-</td>
<td>The domain of the specified user.<br> Leave empty if domain user account is not used.</td>
</tr>
<tr>
<td>Authentication</td>
<td>Ntlm</td>
<td>
<p>Indicates the authentication mode used to connect to the SharePoint server.<br> [<strong>Default</strong>]: Use the credentials from the current security context. No specific account details should be provided. Set this mode when the Connector is used in components running inside SharePoint, such as in webparts. The connector is then authenticated as the current user.<br> [<strong>Ntlm</strong>]: Specifies client authentication using Ntlm. This is the most common scenario.<br> [<strong>Basic</strong>]: Specifies that user authenticates to the server using basic authentication which is a simpler less secure form.<br>[<strong>365</strong>]: Specifies token base authentication against Office 365. Requires that <a href="http://www.microsoft.com/en-us/download/details.aspx?id=17331" target="_blank">Windows Identity Foundation</a> is installed on the server.</p>
</td>
</tr>
<tr>
<td>SSL</td>
<td>False</td>
<td>Boolean value indicating whether connecting to SharePoint using HTTPS.</td>
</tr>
<tr>
<td>SSLAcceptAll</td>
<td>True</td>
<td>Specifies whether the Connector should accept all certificates over HTTPS (less secure), for example self signed certificates. Enhance the security by setting this to False. This however requires that the server certificate is valid.</td>
</tr>
<tr>
<td>MaxBytesPerRead</td>
<td>32768</td>
<td>Sets the maximum data size in bytes returned by the underlying connection per read. Increase this when necessary. <a href="http://msdn.microsoft.com/en-us/library/system.xml.xmldictionaryreaderquotas.maxbytesperread.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>MaxReceivedMessageSize</td>
<td>524288</td>
<td>Sets the maximum total data size in bytes that can be received by the underlying connection. Increase this when necessary. <a href="http://msdn.microsoft.com/en-us/library/system.servicemodel.basichttpbinding.maxreceivedmessagesize.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>MaxArrayLength</td>
<td>16384</td>
<td>This option is rarely specified. <a href="http://msdn.microsoft.com/en-us/library/system.xml.xmldictionaryreaderquotas.maxarraylength.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>MaxDepth</td>
<td>32</td>
<td>This option is rarely specified. <a href="http://msdn.microsoft.com/en-us/library/system.xml.xmldictionaryreaderquotas.maxdepth.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>MaxNameTableCharCount</td>
<td>16384</td>
<td>This option is rarely specified. <a href="http://msdn.microsoft.com/en-us/library/system.xml.xmldictionaryreaderquotas.maxnametablecharcount.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>MaxStringContentLength</td>
<td>8192</td>
<td>This option is rarely specified. <a href="http://msdn.microsoft.com/en-us/library/system.xml.xmldictionaryreaderquotas.maxstringcontentlength.aspx"> Read more on msdn</a>.</td>
</tr>
<tr>
<td>TimeOut</td>
<td>60</td>
<td>Sets the timeout limit in seconds when receiving and sending data. Increase this when necessary.</td>
</tr>
<tr>
<td>RecursiveMode</td>
<td>RecursiveAll</td>
<td>Indicates how to handle SharePoint lists with subfolders when performing SELECT commands.<br> [<strong>FilesOnly</strong>]: Select list items (not folders) from the current folder only.<br> [<strong>Recursive</strong>]: Select list items (not folders) from the current folder and all subfolders recursively.<br> [<strong>RecursiveAll</strong>]: Select list items and folders from the current folder and all subfolders recursively.</td>
</tr>
<tr>
<td>StrictMode</td>
<td>True</td>
<td>When True the Connector always validates values being updated (size, limits, etc) before executing INSERT and UPDATE commands. Set to False to disable all validation and leave this to SharePoint. This option is rarely specified.<br> Note: The SharePoint API is much less restrictive than in the user interface and does not always respect column settings.</td>
</tr>
<tr>
<td>DecodeName</td>
<td>True</td>
<td><span class="obsolete">Obsolete!</span> True means that special characters in column names are automatically decoded when performing SELECT commands. This option is rarely specified.</td>
</tr>
<tr>
<td>DefaultLimit</td>
<td>0</td>
<td>Indcates the default max number of rows returned from SELECT commands. Zero means SharePoint default setting, typically 100 rows. Increase this to select more data from larger lists.<br> Note: This value is always overridden if LIMIT clause is provided in the SELECT command.</td>
</tr>
<tr>
<td>CacheTimeOut</td>
<td>30</td>
<td>Controls the timeout limit in seconds for the built in schema caching mechanism. To increase performance, schemas are automatically cached for a limited amount of time.</td>
</tr>
<tr>
<td>NoListFilters</td>
<td>False</td>
<td>Specify True to disable all list filters when selecting data. By default, when selecting rows from a list, any filters configured on the views in SharePoint will also apply to the selected content. In some cases this is not the desired behavour.</td>
</tr>
<tr>
<td>ExpandUserFields</td>
<td>False</td>
<td>Specify True to make user columns include login name, e-mail address, Session Initiation Protocol (SIP) address, and title. By default, user columns show only ID and Name.</td>
</tr>
<tr>
<td>ServerUrlRelativeList</td>
<td>True</td>
<td>Specify True to ensure that the SharePoint ServerUrl column always show the path relative list.</td>
</tr>
<tr>
<td>StreamBuffering</td>
<td>True</td>
<td>Specifies send method for the UPLOAD procedure. When True, the data is buffered in memory so it is ready to be resent in the event of redirections or authentication requests. Setting this value to False can improve application performance but can cause problems if the SharePoint server does not support pre-authentication.</td>
</tr>
<tr>
<td>FullSchemaOnly</td>
<td>False</td>
<td>When CommandBehavior is set to SchemaOnly and when no view is provided this option specifies that all columns shall be included.</td>
</tr>
<tr>
<td>LogFile</td>
<td>-</td>
<td>File path to log file, e.g. "c:\log.sql". When specified all queries will be logged to this file.</td>
</tr>
<tr>
<td>MaxKeys</td>
<td>25</td>
<td>Specifies maximum number of key values that can be used to improve performance when joining between lists. Increasing this value may lead to improved performance because less data needs to be transfered between SharePoint and the Connector.</td>
</tr>
<tr>
<td>UseDefaultProxy</td>
<td>False</td>
<td>Specifies whether the auto-configured HTTP proxy of the system should be used. For performance reasons the default value is False. Specify True if the proxy settings should be read.</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div><div id="section"><a name="reference-column-types"><i>/3_5/reference/column-types</i></a><div id="rightcontent">                                
            
  
                                          
                              
            
             
  <h1>Column Types</h1>

            
  
  <table border="0" class="doctable">
<tbody>
<tr><th>Name</th><th>.NET Data Type</th><th>Important Attributes</th></tr>
<tr>
<td>AlldayEvent</td>
<td>System.Boolean</td>
<td>-</td>
</tr>
<tr>
<td>Attachments</td>
<td>System.Boolean</td>
<td>-</td>
</tr>
<tr>
<td>Boolean</td>
<td><span>System.Boolean</span></td>
<td>-</td>
</tr>
<tr>
<td>BusinessData</td>
<td><span>System.String</span></td>
<td>-</td>
</tr>
<tr>
<td>Calculated</td>
<td>System.Object</td>
<td>ResultType</td>
</tr>
<tr>
<td>Choice</td>
<td>System.String</td>
<td>EnumValues, Format, FillInChoice</td>
</tr>
<tr>
<td>Computed</td>
<td>System.String</td>
<td>-</td>
</tr>
<tr>
<td>ContentTypeId</td>
<td>System.String</td>
<td>-</td>
</tr>
<tr>
<td>Counter</td>
<td>System.Int32</td>
<td>PrimaryKey</td>
</tr>
<tr>
<td>CrossProjectLink</td>
<td>System.Boolean</td>
<td>-</td>
</tr>
<tr>
<td>Currency</td>
<td>System.Double</td>
<td>Min, Max, Decimals, Percentage, Div, Mult, LCID</td>
</tr>
<tr>
<td>DateTime</td>
<td>System.DateTime</td>
<td>Format</td>
</tr>
<tr>
<td>Guid</td>
<td>System.Guid</td>
<td>-</td>
</tr>
<tr>
<td>Integer</td>
<td>System.Int32</td>
<td>Min, Max</td>
</tr>
<tr>
<td>Lookup</td>
<td>System.Int32</td>
<td>List, FieldRef, ShowField</td>
</tr>
<tr>
<td>LookupMulti</td>
<td>System.Int32[]</td>
<td>List, FieldRef, ShowField</td>
</tr>
<tr>
<td>ModStat</td>
<td>System.Int32</td>
<td>-</td>
</tr>
<tr>
<td>MultiChoice</td>
<td>System.String[]</td>
<td>EnumValues, Format, FillInChoice</td>
</tr>
<tr>
<td>Note</td>
<td>System.String</td>
<td>RichText, RichTextMode, NumLines</td>
</tr>
<tr>
<td>Number</td>
<td>System.Double</td>
<td>Min, Max, Decimals, Percentage, Div, Mult</td>
</tr>
<tr>
<td>Recurrence</td>
<td>System.Boolean</td>
<td>-</td>
</tr>
<tr>
<td>Text</td>
<td>System.String</td>
<td>MaxLength</td>
</tr>
<tr>
<td>URL</td>
<td>System.String</td>
<td>Format</td>
</tr>
<tr>
<td>User</td>
<td>System.Int32</td>
<td>List, FieldRef, ShowField</td>
</tr>
<tr>
<td>UserMulti</td>
<td>System.Int32[]</td>
<td>List, FieldRef, ShowField</td>
</tr>
</tbody>
</table>
  
  <div>
    

<p> </p>
  </div>

        </div><hr/></div></body></html>